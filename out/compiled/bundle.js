var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function i(e){e.forEach(t)}function o(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(e,t){e.appendChild(t)}function s(e,t,n){e.insertBefore(t,n||null)}function l(e){e.parentNode.removeChild(e)}function c(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function p(){return d(" ")}function f(){return d("")}function m(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function h(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e){return""===e?void 0:+e}function v(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function y(e,t){e.value=null==t?"":t}function b(e,t,n,i){e.style.setProperty(t,n,i?"important":"")}function $(e,t){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t)return void(i.selected=!0)}}let w;function x(e){w=e}function D(){if(!w)throw new Error("Function called outside component initialization");return w}function I(){const e=D();return(t,n)=>{const i=e.$$.callbacks[t];if(i){const o=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);i.slice().forEach(t=>{t.call(e,o)})}}}function S(e,t){D().$$.context.set(e,t)}function O(e){return D().$$.context.get(e)}function E(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const U=[],N=[],k=[],G=[],T=Promise.resolve();let j=!1;function L(e){k.push(e)}function V(e){G.push(e)}let A=!1;const P=new Set;function C(){if(!A){A=!0;do{for(let e=0;e<U.length;e+=1){const t=U[e];x(t),_(t.$$)}for(U.length=0;N.length;)N.pop()();for(let e=0;e<k.length;e+=1){const t=k[e];P.has(t)||(P.add(t),t())}k.length=0}while(U.length);for(;G.length;)G.pop()();j=!1,A=!1,P.clear()}}function _(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(L)}}const R=new Set;let W;function F(){W={r:0,c:[],p:W}}function H(){W.r||i(W.c),W=W.p}function M(e,t){e&&e.i&&(R.delete(e),e.i(t))}function B(e,t,n,i){if(e&&e.o){if(R.has(e))return;R.add(e),W.c.push(()=>{R.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}}function J(e,t,n){const i=e.$$.props[t];void 0!==i&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function q(e){e&&e.c()}function K(e,n,a){const{fragment:r,on_mount:s,on_destroy:l,after_update:c}=e.$$;r&&r.m(n,a),L(()=>{const n=s.map(t).filter(o);l?l.push(...n):i(n),e.$$.on_mount=[]}),c.forEach(L)}function z(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(e,t){-1===e.$$.dirty[0]&&(U.push(e),j||(j=!0,T.then(C)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function X(t,o,a,r,s,c,u=[-1]){const d=w;x(t);const p=o.props||{},f=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:u,skip_bound:!1};let m=!1;if(f.ctx=a?a(t,p,(e,n,...i)=>{const o=i.length?i[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),m&&Q(t,e)),n}):[],f.update(),m=!0,i(f.before_update),f.fragment=!!r&&r(f.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);f.fragment&&f.fragment.l(e),e.forEach(l)}else f.fragment&&f.fragment.c();o.intro&&M(t.$$.fragment),K(t,o.target,o.anchor),C()}x(d)}class Z{$destroy(){z(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Y(){}var ee=function(){if("undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime)return!1;if("undefined"!=typeof navigator&&navigator.getDeviceStorage)return!1;try{return new Function("","return true;")()}catch(e){return!1}}();function te(e){return+e==e>>>0&&""!==e}function ne(e){return e===Object(e)}var ie="__proto__"in{}?function(e){return e}:function(e){var t=e.__proto__;if(!t)return e;var n=Object.create(t);return Object.getOwnPropertyNames(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})),n};var oe=new RegExp("^[$_a-zA-Z]+[$_a-zA-Z0-9]*$");function ae(e){return oe.test(e)}var re={};function se(e,t){if(t!==re)throw Error("Use Path.get to retrieve path objects");for(var n=0;n<e.length;n++)this.push(String(e[n]));ee&&this.length&&(this.getValueFrom=this.compiledGetValueFromFn())}var le={};function ce(e){return te(e)?"["+e+"]":'["'+e.replace(/"/g,'\\"')+'"]'}function ue(e){if(void 0===e)return"eof";var t=e.charCodeAt(0);switch(t){case 91:case 93:case 46:case 34:case 39:case 48:return e;case 95:case 36:return"ident";case 32:case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"ws"}return 97<=t&&t<=122||65<=t&&t<=90?"ident":49<=t&&t<=57?"number":"else"}se.get=function(e){if(e instanceof se)return e;if(null!=e&&0!=e.length||(e=""),"string"!=typeof e){if(te(e.length))return new se(e,re);e=String(e)}if(n=le[e])return n;var t=function(e){var t,n,i,o,a,r,s,l=[],c=-1,u="beforePath",d={push:function(){void 0!==i&&(l.push(i),i=void 0)},append:function(){void 0===i?i=n:i+=n}};function p(){if(!(c>=e.length)){var t=e[c+1];return"inSingleQuote"==u&&"'"==t||"inDoubleQuote"==u&&'"'==t?(c++,n=t,d.append(),!0):void 0}}for(;u;)if(c++,"\\"!=(t=e[c])||!p()){if(o=ue(t),"error"==(a=(s=de[u])[o]||s.else||"error"))return;if(u=a[0],r=d[a[1]]||Y,n=void 0===a[2]?t:a[2],r(),"afterPath"===u)return l}}(e);if(!t)return pe;var n=new se(t,re);return le[e]=n,n},se.prototype=ie({__proto__:[],valid:!0,toString:function(){for(var e="",t=0;t<this.length;t++){var n=this[t];ae(n)?e+=t?"."+n:n:e+=ce(n)}return e},getValueFrom:function(e,t){for(var n=0;n<this.length;n++){if(null==e)return;e=e[this[n]]}return e},iterateObjects:function(e,t){for(var n=0;n<this.length;n++){if(n&&(e=e[this[n-1]]),!ne(e))return;t(e,this[n])}},compiledGetValueFromFn:function(){var e="",t="obj";e+="if (obj != null";for(var n,i=0;i<this.length-1;i++)e+=" &&\n     "+(t+=ae(n=this[i])?"."+n:ce(n))+" != null";return e+=")\n",e+="  return "+(t+=ae(n=this[i])?"."+n:ce(n))+";\nelse\n  return undefined;",new Function("obj",e)},setValueFrom:function(e,t){if(!this.length)return!1;for(var n=0;n<this.length-1;n++){if(!ne(e))return!1;e=e[this[n]]}return!!ne(e)&&(e[this[n]]=t,!0)}});var de={beforePath:{ws:["beforePath"],ident:["inIdent","append"],"[":["beforeElement"],eof:["afterPath"]},inPath:{ws:["inPath"],".":["beforeIdent"],"[":["beforeElement"],eof:["afterPath"]},beforeIdent:{ws:["beforeIdent"],ident:["inIdent","append"]},inIdent:{ident:["inIdent","append"],0:["inIdent","append"],number:["inIdent","append"],ws:["inPath","push"],".":["beforeIdent","push"],"[":["beforeElement","push"],eof:["afterPath","push"]},beforeElement:{ws:["beforeElement"],0:["afterZero","append"],number:["inIndex","append"],"'":["inSingleQuote","append",""],'"':["inDoubleQuote","append",""]},afterZero:{ws:["afterElement","push"],"]":["inPath","push"]},inIndex:{0:["inIndex","append"],number:["inIndex","append"],ws:["afterElement"],"]":["inPath","push"]},inSingleQuote:{"'":["afterElement"],eof:["error"],else:["inSingleQuote","append"]},inDoubleQuote:{'"':["afterElement"],eof:["error"],else:["inDoubleQuote","append"]},afterElement:{ws:["afterElement"],"]":["inPath","push"]}},pe=new se("",re);pe.valid=!1,pe.getValueFrom=pe.setValueFrom=function(){};var fe=se,me=function(e,t){if("string"!=typeof t)throw new TypeError("path must be a string");if("object"!=typeof e)throw new TypeError("object must be passed");var n=fe.get(t);if(!n.valid)throw new Error("path is not a valid object path");return n.getValueFrom(e)};let he={sheet:{name:"newSheet",description:"description of what the sheet is",displayColumn:"id",guid:"",columns:[],lines:[],hidden:!1,isProps:!1,configurable:{name:"text",description:"text",displayColumn:"columnSelect@name","columnSelect@name@displayColumn":{allowedTypes:["int","float","text","longtext"]}}},int:{typeStr:"int",guid:"",description:"int field",name:"newInt",min:-1e4,max:1e5,defaultValue:0,iconName:"newInt",configurable:{name:"text",description:"text",min:"int",max:"int",defaultValue:"int"}},float:{typeStr:"float",guid:"",description:"float field",name:"newFloat",min:-1e4,max:1e5,defaultValue:0,iconName:"newFloat",configurable:{name:"text",description:"text",min:"float",max:"float",defaultValue:"float"}},bool:{typeStr:"bool",guid:"",description:"bool field",name:"newBool",defaultValue:!0,iconName:"newBool",configurable:{name:"text",description:"text",defaultValue:"bool"}},text:{typeStr:"text",guid:"",name:"newText",description:"text field",defaultValue:"",iconName:"newText",configurable:{name:"text",description:"text",defaultValue:"text"}},longtext:{typeStr:"longtext",guid:"",name:"newLongText",description:"long text field",defaultValue:"",iconName:"newLongText",configurable:{name:"text",description:"text",defaultValue:"longtext"}},image:{typeStr:"image",guid:"",name:"newImage",description:"new image field",defaultValue:"",iconName:"newImage",configurable:{name:"text",description:"text",defaultValue:"text"}},file:{typeStr:"file",guid:"",name:"newFile",description:"new file field",defaultValue:"",iconName:"newFile",configurable:{name:"text",description:"text",defaultValue:"text"}},enum:{typeStr:"enum",guid:"",name:"newEnum",description:"new enum field",options:"",defaultValue:"",iconName:"newEnum",configurable:{name:"text",description:"text",defaultValue:"text",options:"text"}},multiple:{typeStr:"multiple",guid:"",name:"newMultiple",description:"new multiple field",options:"",defaultValue:"",iconName:"newMulti",displayType:"vertical",configurable:{name:"text",description:"text",defaultValue:"text",options:"text",displayType:"enum","enum@displayType":{options:["vertical","horizontal"]}}},sheetReference:{typeStr:"sheetReference",guid:"",name:"newSheetReference",description:"new sheet reference field",defaultValue:"",iconName:"newSheetLink",configurable:{name:"text",description:"text",defaultValue:"sheetSelect","sheetSelect@defaultValue":{allowEmpty:!0}}},lineReference:{typeStr:"lineReference",guid:"",name:"newLineReference",description:"new line reference field",sheet:"",defaultValue:"",iconName:"newLineLink",configurable:{name:"text",description:"text",sheet:"sheetSelect",defaultValue:"lineSelect@sheet"}},list:{typeStr:"list",guid:"",name:"new list",description:"new list field",sheet:"",defaultValue:[],iconName:"newList",configurable:{name:"text",description:"text"}},props:{typeStr:"props",guid:"",name:"new properties",description:"new properties field",sheet:"",defaultValue:{},iconName:"newProps",configurable:{name:"text",description:"text"}},grid:{typeStr:"grid",guid:"",name:"new grid",description:"new grid field",defaultValue:[!0,!0,!0,!0],schema:[],iconName:"newGrid",length:4,displayWidth:2,columnWidth:50,columnHeight:50,configurable:{name:"text",description:"text",schema:"grid","grid@schema":{allowedTypes:["int","bool","float","text","longtext","lineReference","sheetReference","multiple","enum"]}}}};function ge(t){let n,o,a,r,c,f,g,v,y,b,$,w,x,D,I,S,O,E,U;return{c(){n=u("input"),o=d("Debug\n"),a=u("input"),r=d("Show Line GUIDs\n"),c=u("input"),f=d("Preview List/Props/Grid Fields\n"),g=u("input"),v=d("Show Nested Sheet Names\n"),y=u("input"),b=d("Show Nested Sheet Paths\n"),$=u("input"),w=d("Allow Schema Editing\n"),x=u("input"),D=d("Add/Remove Items\n"),I=u("br"),S=p(),O=u("br"),h(n,"type","checkbox"),h(a,"type","checkbox"),h(c,"type","checkbox"),h(g,"type","checkbox"),h(y,"type","checkbox"),h($,"type","checkbox"),h(x,"type","checkbox")},m(e,i){s(e,n,i),n.checked=t[0],s(e,o,i),s(e,a,i),a.checked=t[1],s(e,r,i),s(e,c,i),c.checked=t[2],s(e,f,i),s(e,g,i),g.checked=t[3],s(e,v,i),s(e,y,i),y.checked=t[4],s(e,b,i),s(e,$,i),$.checked=t[5],s(e,w,i),s(e,x,i),x.checked=t[6],s(e,D,i),s(e,I,i),s(e,S,i),s(e,O,i),E||(U=[m(n,"change",t[7]),m(a,"change",t[8]),m(c,"change",t[9]),m(g,"change",t[10]),m(y,"change",t[11]),m($,"change",t[12]),m(x,"change",t[13])],E=!0)},p(e,[t]){1&t&&(n.checked=e[0]),2&t&&(a.checked=e[1]),4&t&&(c.checked=e[2]),8&t&&(g.checked=e[3]),16&t&&(y.checked=e[4]),32&t&&($.checked=e[5]),64&t&&(x.checked=e[6])},i:e,o:e,d(e){e&&l(n),e&&l(o),e&&l(a),e&&l(r),e&&l(c),e&&l(f),e&&l(g),e&&l(v),e&&l(y),e&&l(b),e&&l($),e&&l(w),e&&l(x),e&&l(D),e&&l(I),e&&l(S),e&&l(O),E=!1,i(U)}}}function ve(e,t,n){let{debug:i}=t,{showLineGUIDs:o}=t,{previewDisclosedFields:a}=t,{showNestedNames:r}=t,{showNestedPaths:s}=t,{allowSchemaEditing:l}=t,{allowAddRemoveItems:c}=t;return e.$$set=e=>{"debug"in e&&n(0,i=e.debug),"showLineGUIDs"in e&&n(1,o=e.showLineGUIDs),"previewDisclosedFields"in e&&n(2,a=e.previewDisclosedFields),"showNestedNames"in e&&n(3,r=e.showNestedNames),"showNestedPaths"in e&&n(4,s=e.showNestedPaths),"allowSchemaEditing"in e&&n(5,l=e.allowSchemaEditing),"allowAddRemoveItems"in e&&n(6,c=e.allowAddRemoveItems)},[i,o,a,r,s,l,c,function(){i=this.checked,n(0,i)},function(){o=this.checked,n(1,o)},function(){a=this.checked,n(2,a)},function(){r=this.checked,n(3,r)},function(){s=this.checked,n(4,s)},function(){l=this.checked,n(5,l)},function(){c=this.checked,n(6,c)}]}class ye extends Z{constructor(e){super(),X(this,e,ve,ge,a,{debug:0,showLineGUIDs:1,previewDisclosedFields:2,showNestedNames:3,showNestedPaths:4,allowSchemaEditing:5,allowAddRemoveItems:6})}}function be(t){let n,o,a;return{c(){n=u("input"),h(n,"class","svelte-1f8cjuc")},m(e,i){s(e,n,i),y(n,t[0]),o||(a=[m(n,"input",t[4]),m(n,"blur",t[2]),m(n,"input",t[1])],o=!0)},p(e,[t]){1&t&&n.value!==e[0]&&y(n,e[0])},i:e,o:e,d(e){e&&l(n),o=!1,i(a)}}}function $e(e,t,n){let{data:i}=t,{sheetGUID:o}=t;const a=I();return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(3,o=e.sheetGUID)},[i,function(){a("message",{type:"update",data:{sheetGUID:o}})},function(){a("message",{type:"validate",data:{sheetGUID:o}})},o,function(){i=this.value,n(0,i)}]}class we extends Z{constructor(e){super(),X(this,e,$e,be,a,{data:0,sheetGUID:3})}}function xe(t){let n,o,a;return{c(){n=u("input"),h(n,"type","checkbox")},m(e,i){s(e,n,i),n.checked=t[0],o||(a=[m(n,"change",t[3]),m(n,"change",t[1])],o=!0)},p(e,[t]){1&t&&(n.checked=e[0])},i:e,o:e,d(e){e&&l(n),o=!1,i(a)}}}function De(e,t,n){let{data:i}=t,{sheetGUID:o}=t;const a=I();return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(2,o=e.sheetGUID)},[i,function(){a("message",{type:"update",data:{sheetGUID:o}})},o,function(){i=this.checked,n(0,i)}]}class Ie extends Z{constructor(e){super(),X(this,e,De,xe,a,{data:0,sheetGUID:2})}}function Se(e,t,n){const i=e.slice();return i[8]=t[n],i[10]=n,i}function Oe(e){let t;return{c(){t=u("option"),t.__value="",t.value=t.__value},m(e,n){s(e,t,n)},d(e){e&&l(t)}}}function Ee(e){let t,n=e[8]+"";return{c(){t=d(n)},m(e,n){s(e,t,n)},p(e,i){2&i&&n!==(n=e[8]+"")&&v(t,n)},d(e){e&&l(t)}}}function Ue(e){let t,n=e[2][e[10]]+"";return{c(){t=d(n)},m(e,n){s(e,t,n)},p(e,i){4&i&&n!==(n=e[2][e[10]]+"")&&v(t,n)},d(e){e&&l(t)}}}function Ne(e){let t,n,i,o;function a(e,t){return e[2].length==e[1].length&&e[2].length>0?Ue:Ee}let c=a(e),d=c(e);return{c(){t=u("option"),d.c(),n=p(),t.__value=i=e[8],t.value=t.__value,t.selected=o=e[0]===e[8]},m(e,i){s(e,t,i),d.m(t,null),r(t,n)},p(e,r){c===(c=a(e))&&d?d.p(e,r):(d.d(1),d=c(e),d&&(d.c(),d.m(t,n))),2&r&&i!==(i=e[8])&&(t.__value=i,t.value=t.__value),3&r&&o!==(o=e[0]===e[8])&&(t.selected=o)},d(e){e&&l(t),d.d()}}}function ke(t){let n,o,a,d,p=t[3]&&Oe(),h=t[1],g=[];for(let e=0;e<h.length;e+=1)g[e]=Ne(Se(t,h,e));return{c(){n=u("select"),p&&p.c(),o=f();for(let e=0;e<g.length;e+=1)g[e].c();void 0===t[0]&&L(()=>t[6].call(n))},m(e,i){s(e,n,i),p&&p.m(n,null),r(n,o);for(let e=0;e<g.length;e+=1)g[e].m(n,null);$(n,t[0]),a||(d=[m(n,"change",t[6]),m(n,"change",t[4])],a=!0)},p(e,[t]){if(e[3]?p||(p=Oe(),p.c(),p.m(n,o)):p&&(p.d(1),p=null),7&t){let i;for(h=e[1],i=0;i<h.length;i+=1){const o=Se(e,h,i);g[i]?g[i].p(o,t):(g[i]=Ne(o),g[i].c(),g[i].m(n,null))}for(;i<g.length;i+=1)g[i].d(1);g.length=h.length}3&t&&$(n,e[0])},i:e,o:e,d(e){e&&l(n),p&&p.d(),c(g,e),a=!1,i(d)}}}function Ge(e,t,n){let{data:i}=t,{sheetGUID:o}=t,{options:a=[]}=t,{aliases:r=[]}=t,{allowEmpty:s=!0}=t;const l=I();return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(5,o=e.sheetGUID),"options"in e&&n(1,a=e.options),"aliases"in e&&n(2,r=e.aliases),"allowEmpty"in e&&n(3,s=e.allowEmpty)},[i,a,r,s,function(){l("message",{type:"update",data:{sheetGUID:o}})},o,function(){i=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(0,i),n(1,a)}]}class Te extends Z{constructor(e){super(),X(this,e,Ge,ke,a,{data:0,sheetGUID:5,options:1,aliases:2,allowEmpty:3})}}var je="top",Le="bottom",Ve="right",Ae="left",Pe="auto",Ce=[je,Le,Ve,Ae],_e="start",Re="end",We="viewport",Fe="popper",He=Ce.reduce((function(e,t){return e.concat([t+"-"+_e,t+"-"+Re])}),[]),Me=[].concat(Ce,[Pe]).reduce((function(e,t){return e.concat([t,t+"-"+_e,t+"-"+Re])}),[]),Be=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Je(e){return e?(e.nodeName||"").toLowerCase():null}function qe(e){if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ke(e){return e instanceof qe(e).Element||e instanceof Element}function ze(e){return e instanceof qe(e).HTMLElement||e instanceof HTMLElement}function Qe(e){return e.split("-")[0]}function Xe(e){return{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}}function Ze(e,t){var n,i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&((n=i)instanceof qe(n).ShadowRoot||n instanceof ShadowRoot)){var o=t;do{if(o&&e.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ye(e){return qe(e).getComputedStyle(e)}function et(e){return["table","td","th"].indexOf(Je(e))>=0}function tt(e){return((Ke(e)?e.ownerDocument:e.document)||window.document).documentElement}function nt(e){return"html"===Je(e)?e:e.assignedSlot||e.parentNode||e.host||tt(e)}function it(e){if(!ze(e)||"fixed"===Ye(e).position)return null;var t=e.offsetParent;if(t){var n=tt(t);if("body"===Je(t)&&"static"===Ye(t).position&&"static"!==Ye(n).position)return n}return t}function ot(e){for(var t=qe(e),n=it(e);n&&et(n)&&"static"===Ye(n).position;)n=it(n);return n&&"body"===Je(n)&&"static"===Ye(n).position?t:n||function(e){for(var t=nt(e);ze(t)&&["html","body"].indexOf(Je(t))<0;){var n=Ye(t);if("none"!==n.transform||"none"!==n.perspective||n.willChange&&"auto"!==n.willChange)return t;t=t.parentNode}return null}(e)||t}function at(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function rt(e,t,n){return Math.max(e,Math.min(t,n))}function st(e){return Object.assign(Object.assign({},{top:0,right:0,bottom:0,left:0}),e)}function lt(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var ct={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ut(e){var t,n=e.popper,i=e.popperRect,o=e.placement,a=e.offsets,r=e.position,s=e.gpuAcceleration,l=e.adaptive,c=e.roundOffsets?function(e){var t=e.x,n=e.y,i=window.devicePixelRatio||1;return{x:Math.round(t*i)/i||0,y:Math.round(n*i)/i||0}}(a):a,u=c.x,d=void 0===u?0:u,p=c.y,f=void 0===p?0:p,m=a.hasOwnProperty("x"),h=a.hasOwnProperty("y"),g=Ae,v=je,y=window;if(l){var b=ot(n);b===qe(n)&&(b=tt(n)),o===je&&(v=Le,f-=b.clientHeight-i.height,f*=s?1:-1),o===Ae&&(g=Ve,d-=b.clientWidth-i.width,d*=s?1:-1)}var $,w=Object.assign({position:r},l&&ct);return s?Object.assign(Object.assign({},w),{},(($={})[v]=h?"0":"",$[g]=m?"0":"",$.transform=(y.devicePixelRatio||1)<2?"translate("+d+"px, "+f+"px)":"translate3d("+d+"px, "+f+"px, 0)",$)):Object.assign(Object.assign({},w),{},((t={})[v]=h?f+"px":"",t[g]=m?d+"px":"",t.transform="",t))}var dt={passive:!0};var pt={left:"right",right:"left",bottom:"top",top:"bottom"};function ft(e){return e.replace(/left|right|bottom|top/g,(function(e){return pt[e]}))}var mt={start:"end",end:"start"};function ht(e){return e.replace(/start|end/g,(function(e){return mt[e]}))}function gt(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height,top:t.top,right:t.right,bottom:t.bottom,left:t.left,x:t.left,y:t.top}}function vt(e){var t=qe(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function yt(e){return gt(tt(e)).left+vt(e).scrollLeft}function bt(e){var t=Ye(e),n=t.overflow,i=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+i)}function $t(e,t){void 0===t&&(t=[]);var n=function e(t){return["html","body","#document"].indexOf(Je(t))>=0?t.ownerDocument.body:ze(t)&&bt(t)?t:e(nt(t))}(e),i="body"===Je(n),o=qe(n),a=i?[o].concat(o.visualViewport||[],bt(n)?n:[]):n,r=t.concat(a);return i?r:r.concat($t(nt(a)))}function wt(e){return Object.assign(Object.assign({},e),{},{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function xt(e,t){return t===We?wt(function(e){var t=qe(e),n=tt(e),i=t.visualViewport,o=n.clientWidth,a=n.clientHeight,r=0,s=0;return i&&(o=i.width,a=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(r=i.offsetLeft,s=i.offsetTop)),{width:o,height:a,x:r+yt(e),y:s}}(e)):ze(t)?function(e){var t=gt(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):wt(function(e){var t=tt(e),n=vt(e),i=e.ownerDocument.body,o=Math.max(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Math.max(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-n.scrollLeft+yt(e),s=-n.scrollTop;return"rtl"===Ye(i||t).direction&&(r+=Math.max(t.clientWidth,i?i.clientWidth:0)-o),{width:o,height:a,x:r,y:s}}(tt(e)))}function Dt(e,t,n){var i="clippingParents"===t?function(e){var t=$t(nt(e)),n=["absolute","fixed"].indexOf(Ye(e).position)>=0&&ze(e)?ot(e):e;return Ke(n)?t.filter((function(e){return Ke(e)&&Ze(e,n)&&"body"!==Je(e)})):[]}(e):[].concat(t),o=[].concat(i,[n]),a=o[0],r=o.reduce((function(t,n){var i=xt(e,n);return t.top=Math.max(i.top,t.top),t.right=Math.min(i.right,t.right),t.bottom=Math.min(i.bottom,t.bottom),t.left=Math.max(i.left,t.left),t}),xt(e,a));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function It(e){return e.split("-")[1]}function St(e){var t,n=e.reference,i=e.element,o=e.placement,a=o?Qe(o):null,r=o?It(o):null,s=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(a){case je:t={x:s,y:n.y-i.height};break;case Le:t={x:s,y:n.y+n.height};break;case Ve:t={x:n.x+n.width,y:l};break;case Ae:t={x:n.x-i.width,y:l};break;default:t={x:n.x,y:n.y}}var c=a?at(a):null;if(null!=c){var u="y"===c?"height":"width";switch(r){case _e:t[c]=t[c]-(n[u]/2-i[u]/2);break;case Re:t[c]=t[c]+(n[u]/2-i[u]/2)}}return t}function Ot(e,t){void 0===t&&(t={});var n=t,i=n.placement,o=void 0===i?e.placement:i,a=n.boundary,r=void 0===a?"clippingParents":a,s=n.rootBoundary,l=void 0===s?We:s,c=n.elementContext,u=void 0===c?Fe:c,d=n.altBoundary,p=void 0!==d&&d,f=n.padding,m=void 0===f?0:f,h=st("number"!=typeof m?m:lt(m,Ce)),g=u===Fe?"reference":Fe,v=e.elements.reference,y=e.rects.popper,b=e.elements[p?g:u],$=Dt(Ke(b)?b:b.contextElement||tt(e.elements.popper),r,l),w=gt(v),x=St({reference:w,element:y,strategy:"absolute",placement:o}),D=wt(Object.assign(Object.assign({},y),x)),I=u===Fe?D:w,S={top:$.top-I.top+h.top,bottom:I.bottom-$.bottom+h.bottom,left:$.left-I.left+h.left,right:I.right-$.right+h.right},O=e.modifiersData.offset;if(u===Fe&&O){var E=O[o];Object.keys(S).forEach((function(e){var t=[Ve,Le].indexOf(e)>=0?1:-1,n=[je,Le].indexOf(e)>=0?"y":"x";S[e]+=E[n]*t}))}return S}function Et(e,t){void 0===t&&(t={});var n=t,i=n.placement,o=n.boundary,a=n.rootBoundary,r=n.padding,s=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?Me:l,u=It(i),d=u?s?He:He.filter((function(e){return It(e)===u})):Ce,p=d.filter((function(e){return c.indexOf(e)>=0}));0===p.length&&(p=d);var f=p.reduce((function(t,n){return t[n]=Ot(e,{placement:n,boundary:o,rootBoundary:a,padding:r})[Qe(n)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}function Ut(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Nt(e){return[je,Ve,Le,Ae].some((function(t){return e[t]>=0}))}function kt(e,t,n){void 0===n&&(n=!1);var i,o=tt(t),a=gt(e),r=ze(t),s={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==Je(t)||bt(o))&&(s=(i=t)!==qe(i)&&ze(i)?function(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}(i):vt(i)),ze(t)?((l=gt(t)).x+=t.clientLeft,l.y+=t.clientTop):o&&(l.x=yt(o))),{x:a.left+s.scrollLeft-l.x,y:a.top+s.scrollTop-l.y,width:a.width,height:a.height}}function Gt(e){var t=new Map,n=new Set,i=[];return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||function e(o){n.add(o.name),[].concat(o.requires||[],o.requiresIfExists||[]).forEach((function(i){if(!n.has(i)){var o=t.get(i);o&&e(o)}})),i.push(o)}(e)})),i}var Tt={placement:"bottom",modifiers:[],strategy:"absolute"};function jt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Lt(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,o=t.defaultOptions,a=void 0===o?Tt:o;return function(e,t,n){void 0===n&&(n=a);var o,r,s={placement:"bottom",orderedModifiers:[],options:Object.assign(Object.assign({},Tt),a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],c=!1,u={state:s,setOptions:function(n){d(),s.options=Object.assign(Object.assign(Object.assign({},a),s.options),n),s.scrollParents={reference:Ke(e)?$t(e):e.contextElement?$t(e.contextElement):[],popper:$t(t)};var o,r,c=function(e){var t=Gt(e);return Be.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((o=[].concat(i,s.options.modifiers),r=o.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign(Object.assign(Object.assign({},n),t),{},{options:Object.assign(Object.assign({},n.options),t.options),data:Object.assign(Object.assign({},n.data),t.data)}):t,e}),{}),Object.keys(r).map((function(e){return r[e]}))));return s.orderedModifiers=c.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var a=o({state:s,name:t,instance:u,options:i}),r=function(){};l.push(a||r)}})),u.update()},forceUpdate:function(){if(!c){var e=s.elements,t=e.reference,n=e.popper;if(jt(t,n)){s.rects={reference:kt(t,ot(n),"fixed"===s.options.strategy),popper:Xe(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<s.orderedModifiers.length;i++)if(!0!==s.reset){var o=s.orderedModifiers[i],a=o.fn,r=o.options,l=void 0===r?{}:r,d=o.name;"function"==typeof a&&(s=a({state:s,options:l,name:d,instance:u})||s)}else s.reset=!1,i=-1}}},update:(o=function(){return new Promise((function(e){u.forceUpdate(),e(s)}))},function(){return r||(r=new Promise((function(e){Promise.resolve().then((function(){r=void 0,e(o())}))}))),r}),destroy:function(){d(),c=!0}};if(!jt(e,t))return u;function d(){l.forEach((function(e){return e()})),l=[]}return u.setOptions(n).then((function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)})),u}}var Vt=Lt({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,o=i.scroll,a=void 0===o||o,r=i.resize,s=void 0===r||r,l=qe(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&c.forEach((function(e){e.addEventListener("scroll",n.update,dt)})),s&&l.addEventListener("resize",n.update,dt),function(){a&&c.forEach((function(e){e.removeEventListener("scroll",n.update,dt)})),s&&l.removeEventListener("resize",n.update,dt)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=St({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,o=void 0===i||i,a=n.adaptive,r=void 0===a||a,s=n.roundOffsets,l=void 0===s||s,c={placement:Qe(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign(Object.assign({},t.styles.popper),ut(Object.assign(Object.assign({},c),{},{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:r,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign(Object.assign({},t.styles.arrow),ut(Object.assign(Object.assign({},c),{},{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign(Object.assign({},t.attributes.popper),{},{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},o=t.elements[e];ze(o)&&Je(o)&&(Object.assign(o.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],o=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});ze(i)&&Je(i)&&(Object.assign(i.style,a),Object.keys(o).forEach((function(e){i.removeAttribute(e)})))}))}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,i=e.name,o=n.offset,a=void 0===o?[0,0]:o,r=Me.reduce((function(e,n){return e[n]=function(e,t,n){var i=Qe(e),o=[Ae,je].indexOf(i)>=0?-1:1,a="function"==typeof n?n(Object.assign(Object.assign({},t),{},{placement:e})):n,r=a[0],s=a[1];return r=r||0,s=(s||0)*o,[Ae,Ve].indexOf(i)>=0?{x:s,y:r}:{x:r,y:s}}(n,t.rects,a),e}),{}),s=r[t.placement],l=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=r}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var o=n.mainAxis,a=void 0===o||o,r=n.altAxis,s=void 0===r||r,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,f=n.flipVariations,m=void 0===f||f,h=n.allowedAutoPlacements,g=t.options.placement,v=Qe(g),y=l||(v===g||!m?[ft(g)]:function(e){if(Qe(e)===Pe)return[];var t=ft(e);return[ht(e),t,ht(t)]}(g)),b=[g].concat(y).reduce((function(e,n){return e.concat(Qe(n)===Pe?Et(t,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:h}):n)}),[]),$=t.rects.reference,w=t.rects.popper,x=new Map,D=!0,I=b[0],S=0;S<b.length;S++){var O=b[S],E=Qe(O),U=It(O)===_e,N=[je,Le].indexOf(E)>=0,k=N?"width":"height",G=Ot(t,{placement:O,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),T=N?U?Ve:Ae:U?Le:je;$[k]>w[k]&&(T=ft(T));var j=ft(T),L=[];if(a&&L.push(G[E]<=0),s&&L.push(G[T]<=0,G[j]<=0),L.every((function(e){return e}))){I=O,D=!1;break}x.set(O,L)}if(D)for(var V=function(e){var t=b.find((function(t){var n=x.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return I=t,"break"},A=m?3:1;A>0;A--){if("break"===V(A))break}t.placement!==I&&(t.modifiersData[i]._skip=!0,t.placement=I,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name,o=n.mainAxis,a=void 0===o||o,r=n.altAxis,s=void 0!==r&&r,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,f=void 0===p||p,m=n.tetherOffset,h=void 0===m?0:m,g=Ot(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),v=Qe(t.placement),y=It(t.placement),b=!y,$=at(v),w="x"===$?"y":"x",x=t.modifiersData.popperOffsets,D=t.rects.reference,I=t.rects.popper,S="function"==typeof h?h(Object.assign(Object.assign({},t.rects),{},{placement:t.placement})):h,O={x:0,y:0};if(x){if(a){var E="y"===$?je:Ae,U="y"===$?Le:Ve,N="y"===$?"height":"width",k=x[$],G=x[$]+g[E],T=x[$]-g[U],j=f?-I[N]/2:0,L=y===_e?D[N]:I[N],V=y===_e?-I[N]:-D[N],A=t.elements.arrow,P=f&&A?Xe(A):{width:0,height:0},C=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},_=C[E],R=C[U],W=rt(0,D[N],P[N]),F=b?D[N]/2-j-W-_-S:L-W-_-S,H=b?-D[N]/2+j+W+R+S:V+W+R+S,M=t.elements.arrow&&ot(t.elements.arrow),B=M?"y"===$?M.clientTop||0:M.clientLeft||0:0,J=t.modifiersData.offset?t.modifiersData.offset[t.placement][$]:0,q=x[$]+F-J-B,K=x[$]+H-J,z=rt(f?Math.min(G,q):G,k,f?Math.max(T,K):T);x[$]=z,O[$]=z-k}if(s){var Q="x"===$?je:Ae,X="x"===$?Le:Ve,Z=x[w],Y=rt(Z+g[Q],Z,Z-g[X]);x[w]=Y,O[w]=Y-Z}t.modifiersData[i]=O}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,i=e.name,o=n.elements.arrow,a=n.modifiersData.popperOffsets,r=Qe(n.placement),s=at(r),l=[Ae,Ve].indexOf(r)>=0?"height":"width";if(o&&a){var c=n.modifiersData[i+"#persistent"].padding,u=Xe(o),d="y"===s?je:Ae,p="y"===s?Le:Ve,f=n.rects.reference[l]+n.rects.reference[s]-a[s]-n.rects.popper[l],m=a[s]-n.rects.reference[s],h=ot(o),g=h?"y"===s?h.clientHeight||0:h.clientWidth||0:0,v=f/2-m/2,y=c[d],b=g-u[l]-c[p],$=g/2-u[l]/2+v,w=rt(y,$,b),x=s;n.modifiersData[i]=((t={})[x]=w,t.centerOffset=w-$,t)}},effect:function(e){var t=e.state,n=e.options,i=e.name,o=n.element,a=void 0===o?"[data-popper-arrow]":o,r=n.padding,s=void 0===r?0:r;null!=a&&("string"!=typeof a||(a=t.elements.popper.querySelector(a)))&&Ze(t.elements.popper,a)&&(t.elements.arrow=a,t.modifiersData[i+"#persistent"]={padding:st("number"!=typeof s?s:lt(s,Ce))})},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,i=t.rects.reference,o=t.rects.popper,a=t.modifiersData.preventOverflow,r=Ot(t,{elementContext:"reference"}),s=Ot(t,{altBoundary:!0}),l=Ut(r,i),c=Ut(s,o,a),u=Nt(l),d=Nt(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign(Object.assign({},t.attributes.popper),{},{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),At={passive:!0},Pt="tippy-content",Ct="tippy-arrow",_t="tippy-svg-arrow";function Rt(e,t,n){if(Array.isArray(e)){var i=e[t];return null==i?Array.isArray(n)?n[t]:n:i}return e}function Wt(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function Ft(e,t){return"function"==typeof e?e.apply(void 0,t):e}function Ht(e,t){return 0===t?e:function(i){clearTimeout(n),n=setTimeout((function(){e(i)}),t)};var n}function Mt(e){return[].concat(e)}function Bt(e,t){-1===e.indexOf(t)&&e.push(t)}function Jt(e){return[].slice.call(e)}function qt(){return document.createElement("div")}function Kt(e){return Wt(e,"Element")}function zt(e){return Kt(e)?[e]:function(e){return Wt(e,"NodeList")}(e)?Jt(e):Array.isArray(e)?e:Jt(document.querySelectorAll(e))}function Qt(e,t){e.forEach((function(e){e&&(e.style.transitionDuration=t+"ms")}))}function Xt(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function Zt(e,t,n){var i=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(t){e[i](t,n)}))}var Yt={isTouch:!1},en=0;function tn(){Yt.isTouch||(Yt.isTouch=!0,window.performance&&document.addEventListener("mousemove",nn))}function nn(){var e=performance.now();e-en<20&&(Yt.isTouch=!1,document.removeEventListener("mousemove",nn)),en=e}function on(){var e,t=document.activeElement;if((e=t)&&e._tippy&&e._tippy.reference===e){var n=t._tippy;t.blur&&!n.state.isVisible&&t.blur()}}var an="undefined"!=typeof window&&"undefined"!=typeof document,rn=an?navigator.userAgent:"",sn=/MSIE |Trident\//.test(rn),ln=an&&/iPhone|iPad|iPod/.test(navigator.platform),cn=Object.assign({appendTo:function(){return document.body},aria:{content:"auto",expanded:"auto"},content:"",delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),un=Object.keys(cn);function dn(e){var t=(e.plugins||[]).reduce((function(t,n){var i=n.name,o=n.defaultValue;return i&&(t[i]=void 0!==e[i]?e[i]:o),t}),{});return Object.assign({},e,{},t)}function pn(e,t){var n=Object.assign({},t,{content:Ft(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(dn(Object.assign({},cn,{plugins:t}))):un).reduce((function(t,n){var i=(e.getAttribute("data-tippy-"+n)||"").trim();if(!i)return t;if("content"===n)t[n]=i;else try{t[n]=JSON.parse(i)}catch(e){t[n]=i}return t}),{})}(e,t.plugins));return n.aria=Object.assign({},cn.aria,{},n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function fn(e,t){e.innerHTML=t}function mn(e){var t=qt();return!0===e?t.className=Ct:(t.className=_t,Kt(e)?t.appendChild(e):fn(t,e)),t}function hn(e,t){Kt(t.content)?(fn(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?fn(e,t.content):e.textContent=t.content)}function gn(e){var t=e.firstElementChild,n=Jt(t.children);return{box:t,content:n.find((function(e){return e.classList.contains(Pt)})),arrow:n.find((function(e){return e.classList.contains(Ct)||e.classList.contains(_t)})),backdrop:n.find((function(e){return e.classList.contains("tippy-backdrop")}))}}function vn(e){var t=qt(),n=qt();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var i=qt();function o(n,i){var o=gn(t),a=o.box,r=o.content,s=o.arrow;i.theme?a.setAttribute("data-theme",i.theme):a.removeAttribute("data-theme"),"string"==typeof i.animation?a.setAttribute("data-animation",i.animation):a.removeAttribute("data-animation"),i.inertia?a.setAttribute("data-inertia",""):a.removeAttribute("data-inertia"),a.style.maxWidth="number"==typeof i.maxWidth?i.maxWidth+"px":i.maxWidth,i.role?a.setAttribute("role",i.role):a.removeAttribute("role"),n.content!==i.content&&hn(r,e.props),i.arrow?s?n.arrow!==i.arrow&&(a.removeChild(s),a.appendChild(mn(i.arrow))):a.appendChild(mn(i.arrow)):s&&a.removeChild(s)}return i.className=Pt,i.setAttribute("data-state","hidden"),hn(i,e.props),t.appendChild(n),n.appendChild(i),o(e.props,e.props),{popper:t,onUpdate:o}}vn.$$tippy=!0;var yn=1,bn=[],$n=[];function wn(e,t){var n,i,o,a,r,s,l,c,u=pn(e,Object.assign({},cn,{},dn(t))),d=!1,p=!1,f=!1,m=[],h=Ht(B,u.interactiveDebounce),g=function(e){var t=Mt(e)[0];return t&&t.ownerDocument||document}(u.triggerTarget||e),v=yn++,y=(c=u.plugins).filter((function(e,t){return c.indexOf(e)===t})),b={id:v,reference:e,popper:qt(),popperInstance:null,props:u,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:y,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(i),cancelAnimationFrame(o)},setProps:function(t){if(b.state.isDestroyed)return;j("onBeforeUpdate",[b,t]),H();var n=b.props,i=pn(e,Object.assign({},b.props,{},t,{ignoreAttributes:!0}));b.props=i,F(),n.interactiveDebounce!==i.interactiveDebounce&&(A(),h=Ht(B,i.interactiveDebounce));n.triggerTarget&&!i.triggerTarget?Mt(n.triggerTarget).forEach((function(e){e.removeAttribute("aria-expanded")})):i.triggerTarget&&e.removeAttribute("aria-expanded");V(),G(),x&&x(n,i);b.popperInstance&&(z(),X().forEach((function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})));j("onAfterUpdate",[b,t])},setContent:function(e){b.setProps({content:e})},show:function(){var e=b.state.isVisible,t=b.state.isDestroyed,n=!b.state.isEnabled,i=Yt.isTouch&&!b.props.touch,o=Rt(b.props.duration,0,cn.duration);if(e||t||n||i)return;if(U().hasAttribute("disabled"))return;if(j("onShow",[b],!1),!1===b.props.onShow(b))return;b.state.isVisible=!0,E()&&(w.style.visibility="visible");G(),C(),b.state.isMounted||(w.style.transition="none");if(E()){var a=N(),r=a.box,l=a.content;Qt([r,l],0)}s=function(){if(b.state.isVisible&&!f){if(f=!0,w.offsetHeight,w.style.transition=b.props.moveTransition,E()&&b.props.animation){var e=N(),t=e.box,n=e.content;Qt([t,n],o),Xt([t,n],"visible")}L(),V(),Bt($n,b),T(!0),b.state.isMounted=!0,j("onMount",[b]),b.props.animation&&E()&&function(e,t){R(e,t)}(o,(function(){b.state.isShown=!0,j("onShown",[b])}))}},function(){var e,t=b.props.appendTo,n=U();e=b.props.interactive&&t===cn.appendTo||"parent"===t?n.parentNode:Ft(t,[n]);e.contains(w)||e.appendChild(w);z()}()},hide:function(){var e=!b.state.isVisible,t=b.state.isDestroyed,n=!b.state.isEnabled,i=Rt(b.props.duration,1,cn.duration);if(e||t||n)return;if(j("onHide",[b],!1),!1===b.props.onHide(b))return;b.state.isVisible=!1,b.state.isShown=!1,f=!1,E()&&(w.style.visibility="hidden");if(A(),_(),G(),E()){var o=N(),a=o.box,r=o.content;b.props.animation&&(Qt([a,r],i),Xt([a,r],"hidden"))}L(),V(),b.props.animation?E()&&function(e,t){R(e,(function(){!b.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&t()}))}(i,b.unmount):b.unmount()},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){b.state.isVisible&&b.hide();if(!b.state.isMounted)return;Q(),X().forEach((function(e){e._tippy.unmount()})),w.parentNode&&w.parentNode.removeChild(w);0===($n=$n.filter((function(e){return e!==b}))).length&&T(!1);b.state.isMounted=!1,j("onHidden",[b])},destroy:function(){if(b.state.isDestroyed)return;b.clearDelayTimeouts(),b.unmount(),H(),delete e._tippy,b.state.isDestroyed=!0,j("onDestroy",[b])}};if(!u.render)return b;var $=u.render(b),w=$.popper,x=$.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+b.id,b.popper=w,e._tippy=b,w._tippy=b;var D=y.map((function(e){return e.fn(b)})),I=e.hasAttribute("aria-expanded");return F(),V(),G(),j("onCreate",[b]),u.showOnCreate&&Z(),w.addEventListener("mouseenter",(function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()})),w.addEventListener("mouseleave",(function(e){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&(g.addEventListener("mousemove",h),h(e))})),b;function S(){var e=b.props.touch;return Array.isArray(e)?e:[e,0]}function O(){return"hold"===S()[0]}function E(){var e;return!!(null==(e=b.props.render)?void 0:e.$$tippy)}function U(){return l||e}function N(){return gn(w)}function k(e){return b.state.isMounted&&!b.state.isVisible||Yt.isTouch||a&&"focus"===a.type?0:Rt(b.props.delay,e?0:1,cn.delay)}function G(){w.style.pointerEvents=b.props.interactive&&b.state.isVisible?"":"none",w.style.zIndex=""+b.props.zIndex}function T(e){var t=e&&ln&&Yt.isTouch;g.body.classList[t?"add":"remove"]("tippy-iOS")}function j(e,t,n){var i;(void 0===n&&(n=!0),D.forEach((function(n){n[e]&&n[e].apply(void 0,t)})),n)&&(i=b.props)[e].apply(i,t)}function L(){var t=b.props.aria;if(t.content){var n="aria-"+t.content,i=w.id;Mt(b.props.triggerTarget||e).forEach((function(e){var t=e.getAttribute(n);if(b.state.isVisible)e.setAttribute(n,t?t+" "+i:i);else{var o=t&&t.replace(i,"").trim();o?e.setAttribute(n,o):e.removeAttribute(n)}}))}}function V(){!I&&b.props.aria.expanded&&Mt(b.props.triggerTarget||e).forEach((function(e){b.props.interactive?e.setAttribute("aria-expanded",b.state.isVisible&&e===U()?"true":"false"):e.removeAttribute("aria-expanded")}))}function A(){g.body.removeEventListener("mouseleave",Y),g.removeEventListener("mousemove",h),bn=bn.filter((function(e){return e!==h}))}function P(e){if(!b.props.interactive||!w.contains(e.target)){if(U().contains(e.target)){if(Yt.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}!0===b.props.hideOnClick&&(d=!1,b.clearDelayTimeouts(),b.hide(),p=!0,setTimeout((function(){p=!1})),b.state.isMounted||_())}}function C(){g.addEventListener("mousedown",P,!0)}function _(){g.removeEventListener("mousedown",P,!0)}function R(e,t){var n=N().box;function i(e){e.target===n&&(Zt(n,"remove",i),t())}if(0===e)return t();Zt(n,"remove",r),Zt(n,"add",i),r=i}function W(t,n,i){void 0===i&&(i=!1),Mt(b.props.triggerTarget||e).forEach((function(e){e.addEventListener(t,n,i),m.push({node:e,eventType:t,handler:n,options:i})}))}function F(){var e;O()&&(W("touchstart",M,At),W("touchend",J,At)),(e=b.props.trigger,e.split(/\s+/).filter(Boolean)).forEach((function(e){if("manual"!==e)switch(W(e,M),e){case"mouseenter":W("mouseleave",J);break;case"focus":W(sn?"focusout":"blur",q);break;case"focusin":W("focusout",q)}}))}function H(){m.forEach((function(e){var t=e.node,n=e.eventType,i=e.handler,o=e.options;t.removeEventListener(n,i,o)})),m=[]}function M(e){var t=!1;if(b.state.isEnabled&&!K(e)&&!p){if(a=e,l=e.currentTarget,V(),!b.state.isVisible&&function(e){return Wt(e,"MouseEvent")}(e)&&bn.forEach((function(t){return t(e)})),"click"===e.type&&(b.props.trigger.indexOf("mouseenter")<0||d)&&!1!==b.props.hideOnClick&&b.state.isVisible)t=!0;else{var i=S(),o=i[0],r=i[1];Yt.isTouch&&"hold"===o&&r?n=setTimeout((function(){Z(e)}),r):Z(e)}"click"===e.type&&(d=!t),t&&Y(e)}}function B(t){var n=t.target,i=e.contains(n)||w.contains(n);"mousemove"===t.type&&i||function(e,t){var n=t.clientX,i=t.clientY;return e.every((function(e){var t=e.popperRect,o=e.popperState,a=e.props.interactiveBorder,r=o.placement.split("-")[0],s=o.modifiersData.offset;if(!s)return!0;var l="bottom"===r?s.top.y:0,c="top"===r?s.bottom.y:0,u="right"===r?s.left.x:0,d="left"===r?s.right.x:0,p=t.top-i+l>a,f=i-t.bottom-c>a,m=t.left-n+u>a,h=n-t.right-d>a;return p||f||m||h}))}(X().concat(w).map((function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:u}:null})).filter(Boolean),t)&&(A(),Y(t))}function J(e){if(!(K(e)||b.props.trigger.indexOf("click")>=0&&d))return b.props.interactive?(g.body.addEventListener("mouseleave",Y),g.addEventListener("mousemove",h),Bt(bn,h),void h(e)):void Y(e)}function q(e){b.props.trigger.indexOf("focusin")<0&&e.target!==U()||b.props.interactive&&e.relatedTarget&&w.contains(e.relatedTarget)||Y(e)}function K(e){return!!Yt.isTouch&&O()!==e.type.indexOf("touch")>=0}function z(){Q();var t=b.props,n=t.popperOptions,i=t.placement,o=t.offset,a=t.getReferenceClientRect,r=t.moveTransition,l=E()?gn(w).arrow:null,c=a?{getBoundingClientRect:a}:e,u={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(E()){var n=N().box;["placement","reference-hidden","escaped"].forEach((function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)})),t.attributes.popper={}}}},d={name:"arrow",enabled:!!l,options:{element:l,padding:3}},p=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!r}}].concat(E()?[d]:[],(null==n?void 0:n.modifiers)||[],[u]);b.popperInstance=Vt(c,w,Object.assign({},n,{placement:i,onFirstUpdate:s,modifiers:p}))}function Q(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function X(){return Jt(w.querySelectorAll("[data-tippy-root]"))}function Z(e){b.clearDelayTimeouts(),e&&j("onTrigger",[b,e]),C();var t=k(!0);t?n=setTimeout((function(){b.show()}),t):b.show()}function Y(e){if(b.clearDelayTimeouts(),j("onUntrigger",[b,e]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&d)){var t=k(!1);t?i=setTimeout((function(){b.state.isVisible&&b.hide()}),t):o=requestAnimationFrame((function(){b.hide()}))}}else _()}}function xn(e,t){void 0===t&&(t={});var n=cn.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",tn,Object.assign({},At,{capture:!0})),window.addEventListener("blur",on);var i=Object.assign({},t,{plugins:n}),o=zt(e).reduce((function(e,t){var n=t&&wn(t,i);return n&&e.push(n),e}),[]);return Kt(e)?o[0]:o}xn.defaultProps=cn,xn.setDefaultProps=function(e){Object.keys(e).forEach((function(t){cn[t]=e[t]}))},xn.currentInput=Yt,xn.setDefaultProps({render:vn});function Dn(e,t){xn(e,t)}function In(t){let n,a,c,d,f,g,v,y=t[1]&&On(t);return{c(){n=u("div"),a=u("img"),f=p(),y&&y.c(),b(a,"width","50px"),a.src!==(c=t[0])&&h(a,"src",c),h(a,"title",t[0]),h(a,"alt",t[0]),h(n,"class","row svelte-8aebs0")},m(i,l){var c;s(i,n,l),r(n,a),r(n,f),y&&y.m(n,null),g||(v=[(c=d=Dn.call(null,a,t[2]),c&&o(c.destroy)?c.destroy:e),m(a,"click",t[3])],g=!0)},p(e,t){1&t&&a.src!==(c=e[0])&&h(a,"src",c),1&t&&h(a,"title",e[0]),1&t&&h(a,"alt",e[0]),d&&o(d.update)&&4&t&&d.update.call(null,e[2]),e[1]?y?y.p(e,t):(y=On(e),y.c(),y.m(n,null)):y&&(y.d(1),y=null)},d(e){e&&l(n),y&&y.d(),g=!1,i(v)}}}function Sn(t){let n,i,o;return{c(){n=u("button"),n.textContent="Pick"},m(e,a){s(e,n,a),i||(o=m(n,"click",t[3]),i=!0)},p:e,d(e){e&&l(n),i=!1,o()}}}function On(t){let n,o,a,c,d,f;return{c(){n=u("div"),o=u("button"),o.textContent="X",a=p(),c=u("button"),c.textContent="...",b(o,"height","25px"),h(o,"title","Clear image"),b(c,"height","25px"),h(c,"title","Change image"),h(n,"class","bCol svelte-8aebs0")},m(e,i){s(e,n,i),r(n,o),r(n,a),r(n,c),d||(f=[m(o,"click",t[4]),m(c,"click",t[3])],d=!0)},p:e,d(e){e&&l(n),d=!1,i(f)}}}function En(t){let n,o,a;function r(e,t){return""==e[0]?Sn:In}let c=r(t),d=c(t);return{c(){n=u("div"),d.c()},m(e,i){s(e,n,i),d.m(n,null),o||(a=[m(n,"mouseover",t[7]),m(n,"mouseleave",t[8])],o=!0)},p(e,[t]){c===(c=r(e))&&d?d.p(e,t):(d.d(1),d=c(e),d&&(d.c(),d.m(n,null)))},i:e,o:e,d(e){e&&l(n),d.d(),o=!1,i(a)}}}function Un(e,t,n){let{data:i}=t,{sheetGUID:o}=t,{fileKey:a}=t;O("nonce");const r=I();let s=!1;let l;return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(5,o=e.sheetGUID),"fileKey"in e&&n(6,a=e.fileKey)},e.$$.update=()=>{1&e.$$.dirty&&n(2,l={content:'<img src="'+i+'">',allowHTML:!0,placement:"bottom",duration:[0,0]})},[i,s,l,function(){r("message",{type:"pickFile",fileKey:a,data:{sheetGUID:o}})},function(){n(0,i=""),r("message",{type:"update",data:{sheetGUID:o}})},o,a,()=>{n(1,s=!0)},()=>{n(1,s=!1)}]}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}('.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}.tippy-iOS{cursor:pointer!important;-webkit-tap-highlight-color:transparent}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:#333;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:#333;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:#333;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:#333;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}');class Nn extends Z{constructor(e){super(),X(this,e,Un,En,a,{data:0,sheetGUID:5,fileKey:6})}}function kn(t){let n,o,a;return{c(){n=u("textarea")},m(e,i){s(e,n,i),y(n,t[0]),o||(a=[m(n,"input",t[3]),m(n,"input",t[1])],o=!0)},p(e,[t]){1&t&&y(n,e[0])},i:e,o:e,d(e){e&&l(n),o=!1,i(a)}}}function Gn(e,t,n){let{data:i}=t,{sheetGUID:o}=t;const a=I();return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(2,o=e.sheetGUID)},[i,function(){a("message",{type:"update",data:{sheetGUID:o}})},o,function(){i=this.value,n(0,i)}]}class Tn extends Z{constructor(e){super(),X(this,e,Gn,kn,a,{data:0,sheetGUID:2})}}function jn(e,t,n){const i=e.slice();return i[8]=t[n],i}function Ln(e){let t;return{c(){t=u("br")},m(e,n){s(e,t,n)},d(e){e&&l(t)}}}function Vn(e){let t,n,o,a,c,g,y,b,$,w=e[8]+"",x="vertical"==e[2]&&Ln();return{c(){t=u("label"),n=u("input"),a=p(),c=d(w),g=p(),x&&x.c(),y=f(),h(n,"type","checkbox"),n.__value=o=e[8],n.value=n.__value,e[6][0].push(n)},m(i,o){s(i,t,o),r(t,n),n.checked=~e[0].indexOf(n.__value),r(t,a),r(t,c),s(i,g,o),x&&x.m(i,o),s(i,y,o),b||($=[m(n,"change",e[5]),m(n,"change",e[3])],b=!0)},p(e,t){2&t&&o!==(o=e[8])&&(n.__value=o,n.value=n.__value),1&t&&(n.checked=~e[0].indexOf(n.__value)),2&t&&w!==(w=e[8]+"")&&v(c,w),"vertical"==e[2]?x||(x=Ln(),x.c(),x.m(y.parentNode,y)):x&&(x.d(1),x=null)},d(o){o&&l(t),e[6][0].splice(e[6][0].indexOf(n),1),o&&l(g),x&&x.d(o),o&&l(y),b=!1,i($)}}}function An(t){let n,i=t[1],o=[];for(let e=0;e<i.length;e+=1)o[e]=Vn(jn(t,i,e));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();n=f()},m(e,t){for(let n=0;n<o.length;n+=1)o[n].m(e,t);s(e,n,t)},p(e,[t]){if(15&t){let a;for(i=e[1],a=0;a<i.length;a+=1){const r=jn(e,i,a);o[a]?o[a].p(r,t):(o[a]=Vn(r),o[a].c(),o[a].m(n.parentNode,n))}for(;a<o.length;a+=1)o[a].d(1);o.length=i.length}},i:e,o:e,d(e){c(o,e),e&&l(n)}}}function Pn(e,t,n){let{data:i}=t,{sheetGUID:o}=t,{options:a}=t,{displayType:r="vertical"}=t;const s=I();const l=[[]];return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(4,o=e.sheetGUID),"options"in e&&n(1,a=e.options),"displayType"in e&&n(2,r=e.displayType)},[i,a,r,function(){s("message",{type:"update",data:{sheetGUID:o}})},o,function(){i=function(e,t,n){const i=new Set;for(let t=0;t<e.length;t+=1)e[t].checked&&i.add(e[t].__value);return n||i.delete(t),Array.from(i)}(l[0],this.__value,this.checked),n(0,i)},l]}class Cn extends Z{constructor(e){super(),X(this,e,Pn,An,a,{data:0,sheetGUID:4,options:1,displayType:2})}}function _n(t){let n,o,a;return{c(){n=u("input"),h(n,"type","number"),h(n,"min",t[1]),h(n,"max",t[2]),h(n,"class","svelte-1f8cjuc")},m(e,i){s(e,n,i),y(n,t[0]),o||(a=[m(n,"input",t[5]),m(n,"input",t[3])],o=!0)},p(e,[t]){2&t&&h(n,"min",e[1]),4&t&&h(n,"max",e[2]),1&t&&g(n.value)!==e[0]&&y(n,e[0])},i:e,o:e,d(e){e&&l(n),o=!1,i(a)}}}function Rn(e,t,n){let{data:i}=t,{sheetGUID:o}=t,{min:a}=t,{max:r}=t;const s=I();return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(4,o=e.sheetGUID),"min"in e&&n(1,a=e.min),"max"in e&&n(2,r=e.max)},[i,a,r,function(){s("message",{type:"update",data:{sheetGUID:o}})},o,function(){i=g(this.value),n(0,i)}]}class Wn extends Z{constructor(e){super(),X(this,e,Rn,_n,a,{data:0,sheetGUID:4,min:1,max:2})}}function Fn(e){let t,n,o,a,r,c,f;return{c(){t=u("button"),t.textContent="Change",n=p(),o=u("button"),o.textContent="Clear",a=p(),r=d(e[0])},m(i,l){s(i,t,l),s(i,n,l),s(i,o,l),s(i,a,l),s(i,r,l),c||(f=[m(t,"click",e[1]),m(o,"click",e[2])],c=!0)},p(e,t){1&t&&v(r,e[0])},d(e){e&&l(t),e&&l(n),e&&l(o),e&&l(a),e&&l(r),c=!1,i(f)}}}function Hn(t){let n,i,o;return{c(){n=u("button"),n.textContent="Pick"},m(e,a){s(e,n,a),i||(o=m(n,"click",t[1]),i=!0)},p:e,d(e){e&&l(n),i=!1,o()}}}function Mn(t){let n;function i(e,t){return""==e[0]?Hn:Fn}let o=i(t),a=o(t);return{c(){a.c(),n=f()},m(e,t){a.m(e,t),s(e,n,t)},p(e,[t]){o===(o=i(e))&&a?a.p(e,t):(a.d(1),a=o(e),a&&(a.c(),a.m(n.parentNode,n)))},i:e,o:e,d(e){a.d(e),e&&l(n)}}}function Bn(e,t,n){let{data:i}=t,{sheetGUID:o}=t,{fileKey:a}=t;O("nonce");const r=I();return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(3,o=e.sheetGUID),"fileKey"in e&&n(4,a=e.fileKey)},[i,function(){r("message",{type:"pickFile",fileKey:a,data:{sheetGUID:o}})},function(){n(0,i=""),r("message",{type:"update",data:{sheetGUID:o}})},o,a]}class Jn extends Z{constructor(e){super(),X(this,e,Bn,Mn,a,{data:0,sheetGUID:3,fileKey:4})}}var qn="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Kn=new Uint8Array(16);function zn(){if(!qn)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qn(Kn)}var Qn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Xn(e){return"string"==typeof e&&Qn.test(e)}for(var Zn=[],Yn=0;Yn<256;++Yn)Zn.push((Yn+256).toString(16).substr(1));function ei(e,t,n){var i=(e=e||{}).random||(e.rng||zn)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=i[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Zn[e[t+0]]+Zn[e[t+1]]+Zn[e[t+2]]+Zn[e[t+3]]+"-"+Zn[e[t+4]]+Zn[e[t+5]]+"-"+Zn[e[t+6]]+Zn[e[t+7]]+"-"+Zn[e[t+8]]+Zn[e[t+9]]+"-"+Zn[e[t+10]]+Zn[e[t+11]]+Zn[e[t+12]]+Zn[e[t+13]]+Zn[e[t+14]]+Zn[e[t+15]]).toLowerCase();if(!Xn(n))throw TypeError("Stringified UUID is invalid");return n}(i)}function ti(e,t,n){const i=e.slice();return i[18]=t[n],i[19]=t,i[20]=n,i}function ni(e,t,n){const i=e.slice();return i[15]=t[n],i[17]=n,i}function ii(e){let t,n,i,o=e[1].schema,a=[];for(let t=0;t<o.length;t+=1)a[t]=ci(ti(e,o,t));const d=e=>B(a[e],1,1,()=>{a[e]=null});return{c(){t=u("tr");for(let e=0;e<a.length;e+=1)a[e].c();n=p()},m(e,o){s(e,t,o);for(let e=0;e<a.length;e+=1)a[e].m(t,null);r(t,n),i=!0},p(e,i){if(7&i){let r;for(o=e[1].schema,r=0;r<o.length;r+=1){const s=ti(e,o,r);a[r]?(a[r].p(s,i),M(a[r],1)):(a[r]=ci(s),a[r].c(),M(a[r],1),a[r].m(t,n))}for(F(),r=o.length;r<a.length;r+=1)d(r);H()}},i(e){if(!i){for(let e=0;e<o.length;e+=1)M(a[e]);i=!0}},o(e){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)B(a[e]);i=!1},d(e){e&&l(t),c(a,e)}}}function oi(e){let t,n,i,o,a,c;const d=[li,si,ri,ai],p=[];function f(e,t){return"text"===e[18]?0:"bool"===e[18]?1:"longtext"===e[18]?2:"float"===e[18]||"int"===e[18]?3:-1}return~(i=f(e))&&(o=p[i]=d[i](e)),{c(){t=u("td"),n=u("div"),o&&o.c(),h(n,"title",a=[e[20]]),b(t,"width",e[1].columnWidth+"px"),b(t,"height",e[1].columnHeight+"px")},m(e,o){s(e,t,o),r(t,n),~i&&p[i].m(n,null),c=!0},p(e,a){let r=i;i=f(e),i===r?~i&&p[i].p(e,a):(o&&(F(),B(p[r],1,1,()=>{p[r]=null}),H()),~i?(o=p[i],o||(o=p[i]=d[i](e),o.c()),M(o,1),o.m(n,null)):o=null),(!c||2&a)&&b(t,"width",e[1].columnWidth+"px"),(!c||2&a)&&b(t,"height",e[1].columnHeight+"px")},i(e){c||(M(o),c=!0)},o(e){B(o),c=!1},d(e){e&&l(t),~i&&p[i].d()}}}function ai(e){let t,n,i;function o(t){e[11].call(null,t,e[20])}let a={sheetGUID:e[2]};return void 0!==e[0][e[20]]&&(a.data=e[0][e[20]]),t=new Wn({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[12]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};4&o&&(a.sheetGUID=e[2]),!n&&1&o&&(n=!0,a.data=e[0][e[20]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function ri(e){let t,n,i;function o(t){e[9].call(null,t,e[20])}let a={sheetGUID:e[2]};return void 0!==e[0][e[20]]&&(a.data=e[0][e[20]]),t=new Tn({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[10]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};4&o&&(a.sheetGUID=e[2]),!n&&1&o&&(n=!0,a.data=e[0][e[20]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function si(e){let t,n,i;function o(t){e[7].call(null,t,e[20])}let a={sheetGUID:e[2]};return void 0!==e[0][e[20]]&&(a.data=e[0][e[20]]),t=new Ie({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[8]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};4&o&&(a.sheetGUID=e[2]),!n&&1&o&&(n=!0,a.data=e[0][e[20]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function li(e){let t,n,i;function o(t){e[5].call(null,t,e[20])}let a={sheetGUID:e[2]};return void 0!==e[0][e[20]]&&(a.data=e[0][e[20]]),t=new we({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[6]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};4&o&&(a.sheetGUID=e[2]),!n&&1&o&&(n=!0,a.data=e[0][e[20]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function ci(e){let t,n,i=e[20]>=e[17]&&e[20]<e[17]+e[1].displayWidth&&oi(e);return{c(){i&&i.c(),t=f()},m(e,o){i&&i.m(e,o),s(e,t,o),n=!0},p(e,n){e[20]>=e[17]&&e[20]<e[17]+e[1].displayWidth?i?(i.p(e,n),2&n&&M(i,1)):(i=oi(e),i.c(),M(i,1),i.m(t.parentNode,t)):i&&(F(),B(i,1,1,()=>{i=null}),H())},i(e){n||(M(i),n=!0)},o(e){B(i),n=!1},d(e){i&&i.d(e),e&&l(t)}}}function ui(e){let t,n,i=e[17]%e[1].displayWidth==0&&ii(e);return{c(){i&&i.c(),t=f()},m(e,o){i&&i.m(e,o),s(e,t,o),n=!0},p(e,n){e[17]%e[1].displayWidth==0?i?(i.p(e,n),2&n&&M(i,1)):(i=ii(e),i.c(),M(i,1),i.m(t.parentNode,t)):i&&(F(),B(i,1,1,()=>{i=null}),H())},i(e){n||(M(i),n=!0)},o(e){B(i),n=!1},d(e){i&&i.d(e),e&&l(t)}}}function di(e){let t,n,i=e[1].schema,o=[];for(let t=0;t<i.length;t+=1)o[t]=ui(ni(e,i,t));const a=e=>B(o[e],1,1,()=>{o[e]=null});return{c(){t=u("table");for(let e=0;e<o.length;e+=1)o[e].c();b(t,"width",e[3]+"px"),b(t,"height",e[4]+"px")},m(e,i){s(e,t,i);for(let e=0;e<o.length;e+=1)o[e].m(t,null);n=!0},p(e,[r]){if(7&r){let n;for(i=e[1].schema,n=0;n<i.length;n+=1){const a=ni(e,i,n);o[n]?(o[n].p(a,r),M(o[n],1)):(o[n]=ui(a),o[n].c(),M(o[n],1),o[n].m(t,null))}for(F(),n=i.length;n<o.length;n+=1)a(n);H()}(!n||8&r)&&b(t,"width",e[3]+"px"),(!n||16&r)&&b(t,"height",e[4]+"px")},i(e){if(!n){for(let e=0;e<i.length;e+=1)M(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)B(o[e]);n=!1},d(e){e&&l(t),c(o,e)}}}function pi(e,t,n){I();let{data:i}=t,{columnData:o}=t,{sheetGUID:a}=t,r=100,s=100;return e.$$set=e=>{"data"in e&&n(0,i=e.data),"columnData"in e&&n(1,o=e.columnData),"sheetGUID"in e&&n(2,a=e.sheetGUID)},e.$$.update=()=>{2&e.$$.dirty&&(n(3,r=o.displayWidth*o.columnWidth),n(4,s=o.length>o.displayWidth?o.length/o.displayWidth*o.columnHeight:o.columnHeight))},[i,o,a,r,s,function(e,t){i[t]=e,n(0,i)},function(t){E(e,t)},function(e,t){i[t]=e,n(0,i)},function(t){E(e,t)},function(e,t){i[t]=e,n(0,i)},function(t){E(e,t)},function(e,t){i[t]=e,n(0,i)},function(t){E(e,t)}]}class fi extends Z{constructor(e){super(),X(this,e,pi,di,a,{data:0,columnData:1,sheetGUID:2})}}function mi(e,t,n){const i=e.slice();return i[81]=t[n],i[83]=n,i}function hi(e,t,n){const i=e.slice();return i[78]=t[n],i[79]=t,i[80]=n,i}function gi(e,t,n){const i=e.slice();return i[75]=t[n],i[76]=t,i[77]=n,i}function vi(e,t,n){const i=e.slice();return i[78]=t[n],i}function yi(e,t,n){const i=e.slice();return i[86]=t[n],i}function bi(e){let t,n,i=e[2]==e[3].guid&&e[10]&&$i(e),o=(e[8]||e[9])&&xi(e);return{c(){i&&i.c(),t=p(),o&&o.c(),n=f()},m(e,a){i&&i.m(e,a),s(e,t,a),o&&o.m(e,a),s(e,n,a)},p(e,a){e[2]==e[3].guid&&e[10]?i?i.p(e,a):(i=$i(e),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null),e[8]||e[9]?o?o.p(e,a):(o=xi(e),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(e){i&&i.d(e),e&&l(t),o&&o.d(e),e&&l(n)}}}function $i(e){let t,n,i=Object.keys(he),o=[];for(let t=0;t<i.length;t+=1)o[t]=wi(yi(e,i,t));return{c(){t=u("tr"),n=u("td");for(let e=0;e<o.length;e+=1)o[e].c();h(n,"colspan",e[16])},m(e,i){s(e,t,i),r(t,n);for(let e=0;e<o.length;e+=1)o[e].m(n,null)},p(e,t){if(8519680&t[0]){let a;for(i=Object.keys(he),a=0;a<i.length;a+=1){const r=yi(e,i,a);o[a]?o[a].p(r,t):(o[a]=wi(r),o[a].c(),o[a].m(n,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=i.length}65536&t[0]&&h(n,"colspan",e[16])},d(e){e&&l(t),c(o,e)}}}function wi(e){let t,n="sheet"!==e[86]&&function(e){let t,n,i,o,a,c,d,f;function g(...t){return e[28](e[86],...t)}return{c(){t=u("button"),n=u("img"),a=p(),n.src!==(i=e[17][he[e[86]].iconName].path)&&h(n,"src",i),h(n,"alt",o="Create new "+e[86]+" column"),h(t,"class","buttonIcon padded svelte-12bkdq0"),h(t,"title",c="Create new "+e[86]+" column")},m(e,i){s(e,t,i),r(t,n),r(t,a),d||(f=m(t,"click",g),d=!0)},p(t,n){e=t},d(e){e&&l(t),d=!1,f()}}}(e);return{c(){n&&n.c(),t=f()},m(e,i){n&&n.m(e,i),s(e,t,i)},p(e,t){"sheet"!==e[86]&&n.p(e,t)},d(e){n&&n.d(e),e&&l(t)}}}function xi(e){let t,n,i,o=e[8]&&Di(e),a=e[9]&&Ii(e);return{c(){t=u("tr"),n=u("td"),o&&o.c(),i=p(),a&&a.c(),h(n,"colspan",e[16])},m(e,l){s(e,t,l),r(t,n),o&&o.m(n,null),r(n,i),a&&a.m(n,null)},p(e,t){e[8]?o?o.p(e,t):(o=Di(e),o.c(),o.m(n,i)):o&&(o.d(1),o=null),e[9]?a?a.p(e,t):(a=Ii(e),a.c(),a.m(n,null)):a&&(a.d(1),a=null),65536&t[0]&&h(n,"colspan",e[16])},d(e){e&&l(t),o&&o.d(),a&&a.d()}}}function Di(e){let t,n,i=e[3].name+"";return{c(){t=u("b"),n=d(i)},m(e,i){s(e,t,i),r(t,n)},p(e,t){8&t[0]&&i!==(i=e[3].name+"")&&v(n,i)},d(e){e&&l(t)}}}function Ii(e){let t,n;return{c(){t=d("@ "),n=d(e[14])},m(e,i){s(e,t,i),s(e,n,i)},p(e,t){16384&t[0]&&v(n,e[14])},d(e){e&&l(t),e&&l(n)}}}function Si(e){let t;return{c(){t=u("th"),t.textContent="GUID"},m(e,n){s(e,t,n)},d(e){e&&l(t)}}}function Oi(e){let t;return{c(){t=u("th"),t.textContent="ID"},m(e,n){s(e,t,n)},d(e){e&&l(t)}}}function Ei(e){let t,n=e[78].name+"";return{c(){t=d(n)},m(e,n){s(e,t,n)},p(e,i){8&i[0]&&n!==(n=e[78].name+"")&&v(t,n)},d(e){e&&l(t)}}}function Ui(e){let t,n,i,o,a,c=e[78].name+"";function p(...t){return e[29](e[78],...t)}return{c(){t=u("a"),n=d(c),h(t,"href",i="#")},m(e,i){s(e,t,i),r(t,n),o||(a=m(t,"click",p),o=!0)},p(t,i){e=t,8&i[0]&&c!==(c=e[78].name+"")&&v(n,c)},d(e){e&&l(t),o=!1,a()}}}function Ni(e){let t,n;function i(e,t){return e[10]?Ui:Ei}let o=i(e),a=o(e);return{c(){t=u("th"),a.c(),h(t,"title",n=e[78].description)},m(e,n){s(e,t,n),a.m(t,null)},p(e,r){o===(o=i(e))&&a?a.p(e,r):(a.d(1),a=o(e),a&&(a.c(),a.m(t,null))),8&r[0]&&n!==(n=e[78].description)&&h(t,"title",n)},d(e){e&&l(t),a.d()}}}function ki(e){let t,n,i,o,a,d,m,h,g=e[11]&&Gi(e),v=e[6]&&Ti(e),y=!e[3].isProps&&ji(e),$=e[3].columns,w=[];for(let t=0;t<$.length;t+=1)w[t]=ro(hi(e,$,t));const x=e=>B(w[e],1,1,()=>{w[e]=null});let D=e[75].guid in e[1]&&so(e);return{c(){t=u("tr"),n=u("td"),g&&g.c(),i=p(),v&&v.c(),o=p(),y&&y.c(),a=p();for(let e=0;e<w.length;e+=1)w[e].c();d=p(),D&&D.c(),m=f(),b(n,"width","17px")},m(e,l){s(e,t,l),r(t,n),g&&g.m(n,null),r(t,i),v&&v.m(t,null),r(t,o),y&&y.m(t,null),r(t,a);for(let e=0;e<w.length;e+=1)w[e].m(t,null);s(e,d,l),D&&D.m(e,l),s(e,m,l),h=!0},p(e,i){if(e[11]?g?g.p(e,i):(g=Gi(e),g.c(),g.m(n,null)):g&&(g.d(1),g=null),e[6]?v?v.p(e,i):(v=Ti(e),v.c(),v.m(t,o)):v&&(v.d(1),v=null),e[3].isProps?y&&(F(),B(y,1,1,()=>{y=null}),H()):y?(y.p(e,i),8&i[0]&&M(y,1)):(y=ji(e),y.c(),M(y,1),y.m(t,a)),33722506&i[0]){let n;for($=e[3].columns,n=0;n<$.length;n+=1){const o=hi(e,$,n);w[n]?(w[n].p(o,i),M(w[n],1)):(w[n]=ro(o),w[n].c(),M(w[n],1),w[n].m(t,null))}for(F(),n=$.length;n<w.length;n+=1)x(n);H()}e[75].guid in e[1]?D?(D.p(e,i),32770&i[0]&&M(D,1)):(D=so(e),D.c(),M(D,1),D.m(m.parentNode,m)):D&&(F(),B(D,1,1,()=>{D=null}),H())},i(e){if(!h){M(y);for(let e=0;e<$.length;e+=1)M(w[e]);M(D),h=!0}},o(e){B(y),w=w.filter(Boolean);for(let e=0;e<w.length;e+=1)B(w[e]);B(D),h=!1},d(e){e&&l(t),g&&g.d(),v&&v.d(),y&&y.d(),c(w,e),e&&l(d),D&&D.d(e),e&&l(m)}}}function Gi(e){let t,n,i,o,a;function c(...t){return e[30](e[77],e[75],...t)}return{c(){t=u("button"),n=u("img"),b(n,"max-width","17px"),n.src!==(i=e[17].removeLine.path)&&h(n,"src",i),h(n,"alt","Remove Line"),h(t,"class","buttonIcon svelte-12bkdq0"),h(t,"title","Remove Line")},m(e,i){s(e,t,i),r(t,n),o||(a=m(t,"click",c),o=!0)},p(t,n){e=t},d(e){e&&l(t),o=!1,a()}}}function Ti(e){let t,n,i=e[75].guid+"";return{c(){t=u("td"),n=d(i)},m(e,i){s(e,t,i),r(t,n)},p(e,t){32768&t[0]&&i!==(i=e[75].guid+"")&&v(n,i)},d(e){e&&l(t)}}}function ji(e){let t,n,i,o;function a(t){e[31].call(null,t,e[75])}let r={sheetGUID:e[3].guid};return void 0!==e[75].id&&(r.data=e[75].id),n=new we({props:r}),N.push(()=>J(n,"data",a)),n.$on("message",(function(...t){return e[32](e[75],...t)})),{c(){t=u("td"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),!i&&32768&o[0]&&(i=!0,a.data=e[75].id,V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function Li(t){let n;function i(e,t){return e[75].guid in e[1]&&e[1][e[75].guid].guid===e[78].guid?Ji:Bi}let o=i(t),a=o(t);return{c(){a.c(),n=f()},m(e,t){a.m(e,t),s(e,n,t)},p(e,t){o===(o=i(e))&&a?a.p(e,t):(a.d(1),a=o(e),a&&(a.c(),a.m(n.parentNode,n)))},i:e,o:e,d(e){a.d(e),e&&l(n)}}}function Vi(e){let t,n,i;function o(t){e[55].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Wn({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[56]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Ai(e){let t,n,i;function o(...t){return e[52](e[78],...t)}function a(t){e[53].call(null,t,e[75],e[78])}let r={sheetGUID:e[3].guid,options:e[3].columns.find(o).options.split(", "),displayType:"displayType"in e[78]?e[78].displayType:"vertical"};return void 0!==e[75][e[78].name]&&(r.data=e[75][e[78].name]),t=new Cn({props:r}),N.push(()=>J(t,"data",a)),t.$on("message",e[54]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,a){e=i;const r={};8&a[0]&&(r.sheetGUID=e[3].guid),8&a[0]&&(r.options=e[3].columns.find(o).options.split(", ")),8&a[0]&&(r.displayType="displayType"in e[78]?e[78].displayType:"vertical"),!n&&32776&a[0]&&(n=!0,r.data=e[75][e[78].name],V(()=>n=!1)),t.$set(r)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Pi(e){let t,n,i,o,a,r=""!==e[75][e[78].name]&&!e[12].lines[e[78].sheet].guids.includes(e[75][e[78].name]);const c=[oo,io],u=[];function d(e,t){return""!==e[78].sheet?0:1}t=d(e),n=u[t]=c[t](e);let m=r&&ao(e);return{c(){n.c(),i=p(),m&&m.c(),o=f()},m(e,n){u[t].m(e,n),s(e,i,n),m&&m.m(e,n),s(e,o,n),a=!0},p(e,a){let s=t;t=d(e),t===s?u[t].p(e,a):(F(),B(u[s],1,1,()=>{u[s]=null}),H(),n=u[t],n||(n=u[t]=c[t](e),n.c()),M(n,1),n.m(i.parentNode,i)),36872&a[0]&&(r=""!==e[75][e[78].name]&&!e[12].lines[e[78].sheet].guids.includes(e[75][e[78].name])),r?m?m.p(e,a):(m=ao(e),m.c(),m.m(o.parentNode,o)):m&&(m.d(1),m=null)},i(e){a||(M(n),a=!0)},o(e){B(n),a=!1},d(e){u[t].d(e),e&&l(i),m&&m.d(e),e&&l(o)}}}function Ci(e){let t,n,i;function o(t){e[46].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid,options:e[12].sheetsFiltered.guids,aliases:e[12].sheetsFiltered.names};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[47]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),4096&o[0]&&(a.options=e[12].sheetsFiltered.guids),4096&o[0]&&(a.aliases=e[12].sheetsFiltered.names),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function _i(e){let t,n,i;function o(...t){return e[43](e[78],...t)}function a(t){e[44].call(null,t,e[75],e[78])}let r={sheetGUID:e[3].guid,options:e[3].columns.find(o).options.split(", ")};return void 0!==e[75][e[78].name]&&(r.data=e[75][e[78].name]),t=new Te({props:r}),N.push(()=>J(t,"data",a)),t.$on("message",e[45]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,a){e=i;const r={};8&a[0]&&(r.sheetGUID=e[3].guid),8&a[0]&&(r.options=e[3].columns.find(o).options.split(", ")),!n&&32776&a[0]&&(n=!0,r.data=e[75][e[78].name],V(()=>n=!1)),t.$set(r)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Ri(e){let t,n,i;function o(t){e[41].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Ie({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[42]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Wi(e){let t,n,i;function o(t){e[39].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid,fileKey:{line:e[75],lineIndex:e[77],column:e[78],columnIndex:e[80]}};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Jn({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[40]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),32776&o[0]&&(a.fileKey={line:e[75],lineIndex:e[77],column:e[78],columnIndex:e[80]}),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Fi(e){let t,n,i;function o(t){e[37].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid,fileKey:{line:e[75],lineIndex:e[77],column:e[78],columnIndex:e[80]}};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Nn({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[38]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),32776&o[0]&&(a.fileKey={line:e[75],lineIndex:e[77],column:e[78],columnIndex:e[80]}),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Hi(e){let t,n,i;function o(t){e[35].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Tn({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[36]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Mi(e){let t,n,i;function o(t){e[33].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new we({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[34]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Bi(e){let t,n,i,o,a,c,d,g;function v(...t){return e[58](e[75],e[78],...t)}let y=e[7]&&qi(e);return{c(){t=u("button"),n=u("img"),a=p(),y&&y.c(),c=f(),n.src!==(i=e[17].hideList.path)&&h(n,"src",i),h(n,"alt",o="Show "+e[78].typeStr),h(t,"class","buttonIcon svelte-12bkdq0")},m(e,i){s(e,t,i),r(t,n),s(e,a,i),y&&y.m(e,i),s(e,c,i),d||(g=m(t,"click",v),d=!0)},p(t,i){e=t,8&i[0]&&o!==(o="Show "+e[78].typeStr)&&h(n,"alt",o),e[7]?y?y.p(e,i):(y=qi(e),y.c(),y.m(c.parentNode,c)):y&&(y.d(1),y=null)},d(e){e&&l(t),e&&l(a),y&&y.d(e),e&&l(c),d=!1,g()}}}function Ji(e){let t,n,i,o,a,c,p;function f(...t){return e[57](e[75],e[78],...t)}return{c(){t=u("button"),n=u("img"),a=d("\n                        ..."),n.src!==(i=e[17].showList.path)&&h(n,"src",i),h(n,"alt",o="Hide "+e[78].typeStr),h(t,"class","buttonIcon svelte-12bkdq0")},m(e,i){s(e,t,i),r(t,n),s(e,a,i),c||(p=m(t,"click",f),c=!0)},p(t,i){e=t,8&i[0]&&o!==(o="Hide "+e[78].typeStr)&&h(n,"alt",o)},d(e){e&&l(t),e&&l(a),c=!1,p()}}}function qi(e){let t;function n(e,t){return"list"===e[78].typeStr?Qi:"props"===e[78].typeStr?zi:"grid"===e[78].typeStr?Ki:void 0}let i=n(e),o=i&&i(e);return{c(){o&&o.c(),t=f()},m(e,n){o&&o.m(e,n),s(e,t,n)},p(e,a){i===(i=n(e))&&o?o.p(e,a):(o&&o.d(1),o=i&&i(e),o&&(o.c(),o.m(t.parentNode,t)))},d(e){o&&o.d(e),e&&l(t)}}}function Ki(e){let t;function n(e,t){return e[75][e[78].name].length>0&&e[75][e[78].name].length<=5?Zi:e[75][e[78].name].length>5?Xi:void 0}let i=n(e),o=i&&i(e);return{c(){o&&o.c(),t=f()},m(e,n){o&&o.m(e,n),s(e,t,n)},p(e,a){i===(i=n(e))&&o?o.p(e,a):(o&&o.d(1),o=i&&i(e),o&&(o.c(),o.m(t.parentNode,t)))},d(e){o&&o.d(e),e&&l(t)}}}function zi(e){let t,n=Object.keys(e[75][e[78].name]),i=[];for(let t=0;t<n.length;t+=1)i[t]=eo(mi(e,n,t));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=d("\n                            ...")},m(e,n){for(let t=0;t<i.length;t+=1)i[t].m(e,n);s(e,t,n)},p(e,o){if(32776&o[0]){let a;for(n=Object.keys(e[75][e[78].name]),a=0;a<n.length;a+=1){const r=mi(e,n,a);i[a]?i[a].p(r,o):(i[a]=eo(r),i[a].c(),i[a].m(t.parentNode,t))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(e){c(i,e),e&&l(t)}}}function Qi(e){let t;function n(e,t){return e[75][e[78].name].length>0&&e[75][e[78].name].length<=5?no:e[75][e[78].name].length>5?to:void 0}let i=n(e),o=i&&i(e);return{c(){o&&o.c(),t=f()},m(e,n){o&&o.m(e,n),s(e,t,n)},p(e,a){i===(i=n(e))&&o?o.p(e,a):(o&&o.d(1),o=i&&i(e),o&&(o.c(),o.m(t.parentNode,t)))},d(e){o&&o.d(e),e&&l(t)}}}function Xi(e){let t,n,i=e[75][e[78].name].slice(0,4)+"";return{c(){t=d(i),n=d("...")},m(e,i){s(e,t,i),s(e,n,i)},p(e,n){32776&n[0]&&i!==(i=e[75][e[78].name].slice(0,4)+"")&&v(t,i)},d(e){e&&l(t),e&&l(n)}}}function Zi(e){let t,n=e[75][e[78].name]+"";return{c(){t=d(n)},m(e,n){s(e,t,n)},p(e,i){32776&i[0]&&n!==(n=e[75][e[78].name]+"")&&v(t,n)},d(e){e&&l(t)}}}function Yi(e){let t,n,i,o,a=e[81]+"",r=e[75][e[78].name][e[81]]+"";return{c(){t=d(a),n=d(" : "),i=d(r),o=d(",")},m(e,a){s(e,t,a),s(e,n,a),s(e,i,a),s(e,o,a)},p(e,n){32776&n[0]&&a!==(a=e[81]+"")&&v(t,a),32776&n[0]&&r!==(r=e[75][e[78].name][e[81]]+"")&&v(i,r)},d(e){e&&l(t),e&&l(n),e&&l(i),e&&l(o)}}}function eo(e){let t,n="guid"!==e[81]&&e[83]<5&&Yi(e);return{c(){n&&n.c(),t=f()},m(e,i){n&&n.m(e,i),s(e,t,i)},p(e,i){"guid"!==e[81]&&e[83]<5?n?n.p(e,i):(n=Yi(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&l(t)}}}function to(e){let t,n,i,o,a,r,c=e[78].name+"",u=e[75][e[78].name].length+"",p=e[75][e[78].name].map(yo).slice(0,4)+"";return{c(){t=d(c),n=d(" ("),i=d(u),o=d(") : "),a=d(p),r=d("...")},m(e,l){s(e,t,l),s(e,n,l),s(e,i,l),s(e,o,l),s(e,a,l),s(e,r,l)},p(e,n){8&n[0]&&c!==(c=e[78].name+"")&&v(t,c),32776&n[0]&&u!==(u=e[75][e[78].name].length+"")&&v(i,u),32776&n[0]&&p!==(p=e[75][e[78].name].map(yo).slice(0,4)+"")&&v(a,p)},d(e){e&&l(t),e&&l(n),e&&l(i),e&&l(o),e&&l(a),e&&l(r)}}}function no(e){let t,n,i,o,a,r=e[78].name+"",c=e[75][e[78].name].length+"",u=e[75][e[78].name].map(vo)+"";return{c(){t=d(r),n=d(" ("),i=d(c),o=d(") : "),a=d(u)},m(e,r){s(e,t,r),s(e,n,r),s(e,i,r),s(e,o,r),s(e,a,r)},p(e,n){8&n[0]&&r!==(r=e[78].name+"")&&v(t,r),32776&n[0]&&c!==(c=e[75][e[78].name].length+"")&&v(i,c),32776&n[0]&&u!==(u=e[75][e[78].name].map(vo)+"")&&v(a,u)},d(e){e&&l(t),e&&l(n),e&&l(i),e&&l(o),e&&l(a)}}}function io(e){let t,n,i;function o(t){e[50].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid,options:[],aliases:[]};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[51]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function oo(e){let t,n,i;function o(t){e[48].call(null,t,e[75],e[78])}let a={sheetGUID:e[3].guid,options:e[12].lines[e[78].sheet].guids,aliases:e[12].lines[e[78].sheet].names};return void 0!==e[75][e[78].name]&&(a.data=e[75][e[78].name]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[49]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};8&o[0]&&(a.sheetGUID=e[3].guid),4104&o[0]&&(a.options=e[12].lines[e[78].sheet].guids),4104&o[0]&&(a.aliases=e[12].lines[e[78].sheet].names),!n&&32776&o[0]&&(n=!0,a.data=e[75][e[78].name],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function ao(e){let t,n,i;return{c(){t=u("div"),n=d("ERROR"),h(t,"title",i="Selected value with GUID "+e[75][e[78].name]+" not in selected sheet. Select proper sheet in column settings")},m(e,i){s(e,t,i),r(t,n)},p(e,n){32776&n[0]&&i!==(i="Selected value with GUID "+e[75][e[78].name]+" not in selected sheet. Select proper sheet in column settings")&&h(t,"title",i)},d(e){e&&l(t)}}}function ro(e){let t,n,i,o,a,c,d;const f=[Mi,Hi,Fi,Wi,Ri,_i,Ci,Pi,Ai,Vi,Li],m=[];function g(e,t){return"text"===e[78].typeStr?0:"longtext"===e[78].typeStr?1:"image"===e[78].typeStr?2:"file"===e[78].typeStr?3:"bool"===e[78].typeStr?4:"enum"===e[78].typeStr?5:"sheetReference"===e[78].typeStr?6:"lineReference"===e[78].typeStr?7:"multiple"===e[78].typeStr?8:"int"===e[78].typeStr||"float"===e[78].typeStr?9:"list"===e[78].typeStr||"props"===e[78].typeStr||"grid"===e[78].typeStr?10:-1}return~(i=g(e))&&(o=m[i]=f[i](e)),{c(){t=u("td"),n=u("div"),o&&o.c(),a=p(),h(t,"title",c=e[78].description)},m(e,o){s(e,t,o),r(t,n),~i&&m[i].m(n,null),r(t,a),d=!0},p(e,a){let r=i;i=g(e),i===r?~i&&m[i].p(e,a):(o&&(F(),B(m[r],1,1,()=>{m[r]=null}),H()),~i?(o=m[i],o||(o=m[i]=f[i](e),o.c()),M(o,1),o.m(n,null)):o=null),(!d||8&a[0]&&c!==(c=e[78].description))&&h(t,"title",c)},i(e){d||(M(o),d=!0)},o(e){B(o),d=!1},d(e){e&&l(t),~i&&m[i].d()}}}function so(e){let t,n,i,o;const a=[co,lo],r=[];function c(e,t){return"list"===e[1][e[75].guid].typeStr||"props"===e[1][e[75].guid].typeStr?0:"grid"===e[1][e[75].guid].typeStr?1:-1}return~(n=c(e))&&(i=r[n]=a[n](e)),{c(){t=u("tr"),i&&i.c()},m(e,i){s(e,t,i),~n&&r[n].m(t,null),o=!0},p(e,o){let s=n;n=c(e),n===s?~n&&r[n].p(e,o):(i&&(F(),B(r[s],1,1,()=>{r[s]=null}),H()),~n?(i=r[n],i||(i=r[n]=a[n](e),i.c()),M(i,1),i.m(t,null)):i=null)},i(e){o||(M(i),o=!0)},o(e){B(i),o=!1},d(e){e&&l(t),~n&&r[n].d()}}}function lo(e){let t,n,i,o,a,r,c,d;function f(t){e[67].call(null,t,e[75])}function m(t){e[68].call(null,t,e[75])}let g={sheetGUID:e[3].guid};return void 0!==e[75][e[1][e[75].guid].name]&&(g.data=e[75][e[1][e[75].guid].name]),void 0!==e[1][e[75].guid]&&(g.columnData=e[1][e[75].guid]),o=new fi({props:g}),N.push(()=>J(o,"data",f)),N.push(()=>J(o,"columnData",m)),o.$on("message",e[69]),{c(){t=u("td"),n=p(),i=u("td"),q(o.$$.fragment),h(i,"colspan",c=e[16]-1)},m(e,a){s(e,t,a),s(e,n,a),s(e,i,a),K(o,i,null),d=!0},p(t,n){e=t;const s={};8&n[0]&&(s.sheetGUID=e[3].guid),!a&&32770&n[0]&&(a=!0,s.data=e[75][e[1][e[75].guid].name],V(()=>a=!1)),!r&&32770&n[0]&&(r=!0,s.columnData=e[1][e[75].guid],V(()=>r=!1)),o.$set(s),(!d||65536&n[0]&&c!==(c=e[16]-1))&&h(i,"colspan",c)},i(e){d||(M(o.$$.fragment,e),d=!0)},o(e){B(o.$$.fragment,e),d=!1},d(e){e&&l(t),e&&l(n),e&&l(i),z(o)}}}function co(e){let t,n,i,o,a,r,c,d,f,m,g;function v(...t){return e[59](e[75],...t)}function y(t){e[60].call(null,t)}function b(...t){return e[62](e[75],...t)}function $(t){e[61].call(null,t,e[75])}function w(...t){return e[64](e[75],...t)}function x(t){e[63].call(null,t,e[75])}function D(t){e[65].call(null,t)}function I(t){e[66].call(null,t)}let S={debug:e[5],showLineGUIDs:e[6],showNestedNames:e[8],showNestedPaths:e[9],allowSchemaEditing:e[10],allowAddRemoveItems:e[11],originLineGUID:e[75].guid,depotInfo:e[12],parentGUID:e[3].guid,baseDataPath:e[14]+(e[3].isProps?".":"["+e[77]+"].")+e[0].sheets[e[0].sheets.findIndex(v)].name};return void 0!==e[0]&&(S.fullData=e[0]),void 0!==e[0].sheets[e[0].sheets.findIndex(b)]&&(S.sheetData=e[0].sheets[e[0].sheets.findIndex(b)]),void 0!==e[15][e[15].findIndex(w)][e[1][e[75].guid].name]&&(S.inputLineData=e[15][e[15].findIndex(w)][e[1][e[75].guid].name]),void 0!==e[1]&&(S.listVisibility=e[1]),void 0!==e[2]&&(S.lastHovered=e[2]),o=new $o({props:S}),N.push(()=>J(o,"fullData",y)),N.push(()=>J(o,"sheetData",$)),N.push(()=>J(o,"inputLineData",x)),N.push(()=>J(o,"listVisibility",D)),N.push(()=>J(o,"lastHovered",I)),o.$on("message",e[24]),{c(){t=u("td"),n=p(),i=u("td"),q(o.$$.fragment),h(i,"colspan",m=e[16]-1)},m(e,a){s(e,t,a),s(e,n,a),s(e,i,a),K(o,i,null),g=!0},p(t,n){e=t;const s={};32&n[0]&&(s.debug=e[5]),64&n[0]&&(s.showLineGUIDs=e[6]),256&n[0]&&(s.showNestedNames=e[8]),512&n[0]&&(s.showNestedPaths=e[9]),1024&n[0]&&(s.allowSchemaEditing=e[10]),2048&n[0]&&(s.allowAddRemoveItems=e[11]),32768&n[0]&&(s.originLineGUID=e[75].guid),4096&n[0]&&(s.depotInfo=e[12]),8&n[0]&&(s.parentGUID=e[3].guid),49163&n[0]&&(s.baseDataPath=e[14]+(e[3].isProps?".":"["+e[77]+"].")+e[0].sheets[e[0].sheets.findIndex(v)].name),!a&&1&n[0]&&(a=!0,s.fullData=e[0],V(()=>a=!1)),!r&&32771&n[0]&&(r=!0,s.sheetData=e[0].sheets[e[0].sheets.findIndex(b)],V(()=>r=!1)),!c&&32770&n[0]&&(c=!0,s.inputLineData=e[15][e[15].findIndex(w)][e[1][e[75].guid].name],V(()=>c=!1)),!d&&2&n[0]&&(d=!0,s.listVisibility=e[1],V(()=>d=!1)),!f&&4&n[0]&&(f=!0,s.lastHovered=e[2],V(()=>f=!1)),o.$set(s),(!g||65536&n[0]&&m!==(m=e[16]-1))&&h(i,"colspan",m)},i(e){g||(M(o.$$.fragment,e),g=!0)},o(e){B(o.$$.fragment,e),g=!1},d(e){e&&l(t),e&&l(n),e&&l(i),z(o)}}}function uo(e){let t,n,i=0!==Object.keys(e[75]).length,o=i&&ki(e);return{c(){o&&o.c(),t=f()},m(e,i){o&&o.m(e,i),s(e,t,i),n=!0},p(e,n){32768&n[0]&&(i=0!==Object.keys(e[75]).length),i?o?(o.p(e,n),32768&n[0]&&M(o,1)):(o=ki(e),o.c(),M(o,1),o.m(t.parentNode,t)):o&&(F(),B(o,1,1,()=>{o=null}),H())},i(e){n||(M(o),n=!0)},o(e){B(o),n=!1},d(e){o&&o.d(e),e&&l(t)}}}function po(e){let t,n;function i(e,n){return(null==t||24&n[0])&&(t=!(!e[3].isProps||0!==Object.keys(e[4]).length)),t?mo:e[3].isProps?void 0:fo}let o=i(e,[-1]),a=o&&o(e);return{c(){a&&a.c(),n=f()},m(e,t){a&&a.m(e,t),s(e,n,t)},p(e,t){o===(o=i(e,t))&&a?a.p(e,t):(a&&a.d(1),a=o&&o(e),a&&(a.c(),a.m(n.parentNode,n)))},d(e){a&&a.d(e),e&&l(n)}}}function fo(e){let t,n,o,a,c,d,f,g,v,y,b,$,w,x,D,I,S,O;return{c(){t=u("tr"),n=u("td"),o=p(),a=u("td"),c=u("button"),d=u("img"),g=p(),v=u("button"),y=u("img"),$=p(),w=u("button"),x=u("img"),d.src!==(f=e[17].addOneLine.path)&&h(d,"src",f),h(d,"alt","Add one line"),h(c,"class","buttonIcon addLine svelte-12bkdq0"),h(c,"title","Add one line"),y.src!==(b=e[17].addFiveLines.path)&&h(y,"src",b),h(y,"alt","Add five lines"),h(v,"class","buttonIcon addLine svelte-12bkdq0"),h(v,"title","Add five lines"),x.src!==(D=e[17].addTenLines.path)&&h(x,"src",D),h(x,"alt","Add ten lines"),h(w,"class","buttonIcon addLine svelte-12bkdq0"),h(w,"alt","Add ten lines"),h(a,"colspan",I=e[16]-1)},m(i,l){s(i,t,l),r(t,n),r(t,o),r(t,a),r(a,c),r(c,d),r(a,g),r(a,v),r(v,y),r(a,$),r(a,w),r(w,x),S||(O=[m(c,"click",e[71]),m(v,"click",e[72]),m(w,"click",e[73])],S=!0)},p(e,t){65536&t[0]&&I!==(I=e[16]-1)&&h(a,"colspan",I)},d(e){e&&l(t),S=!1,i(O)}}}function mo(e){let t,n,i,o,a,c,d,f,g,v;return{c(){t=u("tr"),n=u("td"),i=p(),o=u("td"),a=u("button"),c=u("img"),c.src!==(d=e[17].addPropsLine.path)&&h(c,"src",d),h(c,"alt","Add props"),h(a,"class","buttonIcon addLine svelte-12bkdq0"),h(a,"title","Add props"),h(o,"colspan",f=e[16]-1)},m(l,u){s(l,t,u),r(t,n),r(t,i),r(t,o),r(o,a),r(a,c),g||(v=m(a,"click",e[70]),g=!0)},p(e,t){65536&t[0]&&f!==(f=e[16]-1)&&h(o,"colspan",f)},d(e){e&&l(t),g=!1,v()}}}function ho(e){let t,n,i,o,a,c,f=JSON.stringify({sheetData:e[3]},null,2)+"";return{c(){t=u("p"),t.textContent="Current Table Data:",n=p(),i=u("pre"),o=d(f),a=p(),c=u("p"),c.textContent="----------------------------------------"},m(e,l){s(e,t,l),s(e,n,l),s(e,i,l),r(i,o),s(e,a,l),s(e,c,l)},p(e,t){8&t[0]&&f!==(f=JSON.stringify({sheetData:e[3]},null,2)+"")&&v(o,f)},d(e){e&&l(t),e&&l(n),e&&l(i),e&&l(a),e&&l(c)}}}function go(e){let t,n,o,a,d,h,g,v,y,b,$,w,x,D,I=e[3].hidden&&bi(e),S=e[6]&&Si(),O=!e[3].isProps&&Oi(),E=e[3].columns,U=[];for(let t=0;t<E.length;t+=1)U[t]=Ni(vi(e,E,t));let N=e[15],k=[];for(let t=0;t<N.length;t+=1)k[t]=uo(gi(e,N,t));const G=e=>B(k[e],1,1,()=>{k[e]=null});let T=e[11]&&po(e),j=e[5]&&ho(e);return{c(){t=u("table"),I&&I.c(),n=p(),o=u("tr"),a=u("th"),d=p(),S&&S.c(),h=p(),O&&O.c(),g=p();for(let e=0;e<U.length;e+=1)U[e].c();v=p();for(let e=0;e<k.length;e+=1)k[e].c();y=p(),T&&T.c(),b=p(),j&&j.c(),$=f()},m(i,l){s(i,t,l),I&&I.m(t,null),r(t,n),r(t,o),r(o,a),r(o,d),S&&S.m(o,null),r(o,h),O&&O.m(o,null),r(o,g);for(let e=0;e<U.length;e+=1)U[e].m(o,null);r(t,v);for(let e=0;e<k.length;e+=1)k[e].m(t,null);r(t,y),T&&T.m(t,null),s(i,b,l),j&&j.m(i,l),s(i,$,l),w=!0,x||(D=[m(t,"mouseenter",e[18]),m(t,"mouseleave",e[19])],x=!0)},p(e,i){if(e[3].hidden?I?I.p(e,i):(I=bi(e),I.c(),I.m(t,n)):I&&(I.d(1),I=null),e[6]?S||(S=Si(),S.c(),S.m(o,h)):S&&(S.d(1),S=null),e[3].isProps?O&&(O.d(1),O=null):O||(O=Oi(),O.c(),O.m(o,g)),1049608&i[0]){let t;for(E=e[3].columns,t=0;t<E.length;t+=1){const n=vi(e,E,t);U[t]?U[t].p(n,i):(U[t]=Ni(n),U[t].c(),U[t].m(o,null))}for(;t<U.length;t+=1)U[t].d(1);U.length=E.length}if(119799791&i[0]){let n;for(N=e[15],n=0;n<N.length;n+=1){const o=gi(e,N,n);k[n]?(k[n].p(o,i),M(k[n],1)):(k[n]=uo(o),k[n].c(),M(k[n],1),k[n].m(t,y))}for(F(),n=N.length;n<k.length;n+=1)G(n);H()}e[11]?T?T.p(e,i):(T=po(e),T.c(),T.m(t,null)):T&&(T.d(1),T=null),e[5]?j?j.p(e,i):(j=ho(e),j.c(),j.m($.parentNode,$)):j&&(j.d(1),j=null)},i(e){if(!w){for(let e=0;e<N.length;e+=1)M(k[e]);w=!0}},o(e){k=k.filter(Boolean);for(let e=0;e<k.length;e+=1)B(k[e]);w=!1},d(e){e&&l(t),I&&I.d(),S&&S.d(),O&&O.d(),c(U,e),c(k,e),T&&T.d(),e&&l(b),j&&j.d(e),e&&l($),x=!1,i(D)}}}const vo=e=>e.id,yo=e=>e.id;function bo(e,t,n){let i,{fullData:o}=t,{sheetData:a}=t,{inputLineData:r}=t,{debug:s}=t,{showLineGUIDs:l}=t,{previewDisclosedFields:c}=t,{showNestedNames:u}=t,{showNestedPaths:d}=t,{allowSchemaEditing:p}=t,{allowAddRemoveItems:f}=t,{depotInfo:m}=t,{originLineGUID:h=""}=t,{listVisibility:g={}}=t;const v=I();let y=O("iconPaths"),{lastHovered:b}=t,{parentGUID:$=""}=t,{baseDataPath:w=""}=t;function x(e){v("message",{type:"editorUpdate",data:{active:!0,operation:"edit",editType:e,sheetGUID:a.guid}})}function D(e,t,n){v("message",{type:"lineEdit",data:{operation:"remove",lineIndex:e,line:t,originLineGUID:n,sheetGUID:a.guid}})}function S(e,t){v("message",{type:"lineEdit",data:{operation:"add",amount:e,originLineGUID:t,sheetGUID:a.guid}})}function U(e){v("message",{type:"editorUpdate",data:{active:!0,operation:"new",editType:e,sheetGUID:a.guid}})}let N=0;function k(e,t,i){i?n(1,g[e.guid]=t,g):delete g[e.guid],n(1,g)}function G(e,t){switch(e.detail.type){case"validate":i.forEach(e=>{if(t.guid!==e.guid&&t.id===e.id){let e=i.findIndex(e=>e.guid===t.guid);n(15,i[e].id="DUPLICATE("+t.id+")",i)}}),v("message",{type:"update",data:{sheetGUID:a.guid}});break;default:v("message",e.detail)}}return e.$$set=e=>{"fullData"in e&&n(0,o=e.fullData),"sheetData"in e&&n(3,a=e.sheetData),"inputLineData"in e&&n(4,r=e.inputLineData),"debug"in e&&n(5,s=e.debug),"showLineGUIDs"in e&&n(6,l=e.showLineGUIDs),"previewDisclosedFields"in e&&n(7,c=e.previewDisclosedFields),"showNestedNames"in e&&n(8,u=e.showNestedNames),"showNestedPaths"in e&&n(9,d=e.showNestedPaths),"allowSchemaEditing"in e&&n(10,p=e.allowSchemaEditing),"allowAddRemoveItems"in e&&n(11,f=e.allowAddRemoveItems),"depotInfo"in e&&n(12,m=e.depotInfo),"originLineGUID"in e&&n(13,h=e.originLineGUID),"listVisibility"in e&&n(1,g=e.listVisibility),"lastHovered"in e&&n(2,b=e.lastHovered),"parentGUID"in e&&n(27,$=e.parentGUID),"baseDataPath"in e&&n(14,w=e.baseDataPath)},e.$$.update=()=>{16&e.$$.dirty[0]&&(Array.isArray(r)?n(15,i=r):n(15,i=[r])),72&e.$$.dirty[0]&&(console.log(a),n(16,N=l?a.columns.length+3:a.columns.length+2))},[o,g,b,a,r,s,l,c,u,d,p,f,m,h,w,i,N,y,function(){v("message",{type:"hoverUpdate",data:{action:"enter",sheetGUID:a.guid,parentGUID:$}})},function(){b==a.guid&&n(2,b=""),v("message",{type:"hoverUpdate",data:{action:"exit",sheetGUID:a.guid,parentGUID:$}})},x,D,S,U,function(e){switch(console.log("handing subtable event"),console.log(e),console.log(h),e.detail.type){case"lineEdit":let l=e.detail.data.sheetGUID,c=o.sheets.findIndex(e=>e.guid===l);var t=i.findIndex(t=>t.guid===e.detail.data.originLineGUID),r=g[e.detail.data.originLineGUID];switch(e.detail.data.operation){case"add":console.log("adding nested line from",l,"with index",c,"from line",h,"with index",t,"at column",r.name,"with guid",r.guid);for(let a=1;a<=e.detail.data.amount;a++){var s={};s.guid=ei(),o.sheets[c].columns.forEach(e=>{"multiple"==e.typeStr?s[e.name]=e.defaultValue.split(", "):s[e.name]=e.defaultValue}),o.sheets[c].isProps?n(15,i[t][r.name]=s,i):(s.id=i[t][r.name].length+"",i[t][r.name].push(s))}break;case"remove":o.sheets[c].isProps?n(15,i[t][r.name]={},i):i[t][r.name].splice(e.detail.data.lineIndex,1),i[t].guid in g&&delete g[t]}v("message",{type:"update",data:{sheetGUID:l}});break;case"hoverUpdate":let u=e.detail.data.sheetGUID;switch(e.detail.data.action){case"enter":n(2,b=u);break;case"exit":e.detail.data.parentGUID===a.guid&&n(2,b=a.guid)}v("message",e.detail);break;default:v("message",e.detail)}},k,G,$,e=>U(e),e=>x(e.name),(e,t)=>D(e,t,h),function(e,t){t.id=e,n(15,i),n(4,r)},(e,t)=>G(t,e),function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},(e,t)=>t.name===e.name,function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},(e,t)=>t.name===e.name,function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},function(e,t,o){t[o.name]=e,n(15,i),n(4,r)},function(t){E(e,t)},(e,t)=>k(e,t,!1),(e,t)=>k(e,t,!0),(e,t)=>t.guid===g[e.guid].sheet,function(e){o=e,n(0,o)},function(e,t){o.sheets[o.sheets.findIndex(e=>e.guid===g[t.guid].sheet)]=e,n(0,o)},(e,t)=>t.guid===g[e.guid].sheet,function(e,t){i[i.findIndex(e=>e.guid===t.guid)][g[t.guid].name]=e,n(15,i),n(4,r)},(e,t)=>t.guid===e.guid,function(e){g=e,n(1,g)},function(e){b=e,n(2,b)},function(e,t){t[g[t.guid].name]=e,n(15,i),n(4,r)},function(e,t){g[t.guid]=e,n(1,g)},function(t){E(e,t)},()=>S(1,h),()=>S(1,h),()=>S(5,h),()=>S(10,h)]}class $o extends Z{constructor(e){super(),X(this,e,bo,go,a,{fullData:0,sheetData:3,inputLineData:4,debug:5,showLineGUIDs:6,previewDisclosedFields:7,showNestedNames:8,showNestedPaths:9,allowSchemaEditing:10,allowAddRemoveItems:11,depotInfo:12,originLineGUID:13,listVisibility:1,lastHovered:2,parentGUID:27,baseDataPath:14},[-1,-1,-1])}}function wo(e){let t,n,i;function o(t){e[4].call(null,t)}let a={options:[],aliases:[]};return void 0!==e[0]&&(a.data=e[0]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(e,i){const o={};!n&&1&i&&(n=!0,o.data=e[0],V(()=>n=!1)),t.$set(o)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function xo(e){let t,n,i;function o(t){e[3].call(null,t)}let a={options:e[2].depotInfo.lines[e[1]].guids,aliases:e[2].depotInfo.lines[e[1]].names};return void 0!==e[0]&&(a.data=e[0]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(e,i){const o={};6&i&&(o.options=e[2].depotInfo.lines[e[1]].guids),6&i&&(o.aliases=e[2].depotInfo.lines[e[1]].names),!n&&1&i&&(n=!0,o.data=e[0],V(()=>n=!1)),t.$set(o)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Do(e){let t,n,i,o;const a=[xo,wo],r=[];function c(e,t){return""!==e[1]?0:1}return t=c(e),n=r[t]=a[t](e),{c(){n.c(),i=f()},m(e,n){r[t].m(e,n),s(e,i,n),o=!0},p(e,[o]){let s=t;t=c(e),t===s?r[t].p(e,o):(F(),B(r[s],1,1,()=>{r[s]=null}),H(),n=r[t],n||(n=r[t]=a[t](e),n.c()),M(n,1),n.m(i.parentNode,i))},i(e){o||(M(n),o=!0)},o(e){B(n),o=!1},d(e){r[t].d(e),e&&l(i)}}}function Io(e,t,n){let{data:i}=t,{sheetGUID:o}=t,{config:a}=t;return e.$$set=e=>{"data"in e&&n(0,i=e.data),"sheetGUID"in e&&n(1,o=e.sheetGUID),"config"in e&&n(2,a=e.config)},[i,o,a,function(e){i=e,n(0,i)},function(e){i=e,n(0,i)}]}class So extends Z{constructor(e){super(),X(this,e,Io,Do,a,{data:0,sheetGUID:1,config:2})}}function Oo(e){let t,n,i;function o(t){e[8].call(null,t)}let a={allowEmpty:!1,options:[]};return void 0!==e[0]&&(a.data=e[0]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(e,i){const o={};!n&&1&i&&(n=!0,o.data=e[0],V(()=>n=!1)),t.$set(o)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Eo(e){let t,n,i,o;const a=[No,Uo],r=[];function c(e,t){return"new"===e[2].operation&&"sheet"===e[2].editType?0:1}return t=c(e),n=r[t]=a[t](e),{c(){n.c(),i=f()},m(e,n){r[t].m(e,n),s(e,i,n),o=!0},p(e,o){let s=t;t=c(e),t===s?r[t].p(e,o):(F(),B(r[s],1,1,()=>{r[s]=null}),H(),n=r[t],n||(n=r[t]=a[t](e),n.c()),M(n,1),n.m(i.parentNode,i))},i(e){o||(M(n),o=!0)},o(e){B(n),o=!1},d(e){r[t].d(e),e&&l(i)}}}function Uo(e){let t,n,i;function o(t){e[7].call(null,t)}let a={allowEmpty:!1,options:e[3]};return void 0!==e[0]&&(a.data=e[0]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(e,i){const o={};8&i&&(o.options=e[3]),!n&&1&i&&(n=!0,o.data=e[0],V(()=>n=!1)),t.$set(o)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function No(e){let t,n,i;function o(t){e[6].call(null,t)}let a={allowEmpty:!1,options:["id","guid"],config:e[2]};return void 0!==e[0]&&(a.data=e[0]),t=new Te({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(e,i){const o={};4&i&&(o.config=e[2]),!n&&1&i&&(n=!0,o.data=e[0],V(()=>n=!1)),t.$set(o)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function ko(e){let t,n,i,o;const a=[Eo,Oo],r=[];function c(e,t){return""!==e[1]?0:1}return t=c(e),n=r[t]=a[t](e),{c(){n.c(),i=f()},m(e,n){r[t].m(e,n),s(e,i,n),o=!0},p(e,[o]){let s=t;t=c(e),t===s?r[t].p(e,o):(F(),B(r[s],1,1,()=>{r[s]=null}),H(),n=r[t],n||(n=r[t]=a[t](e),n.c()),M(n,1),n.m(i.parentNode,i))},i(e){o||(M(n),o=!0)},o(e){B(n),o=!1},d(e){r[t].d(e),e&&l(i)}}}function Go(e,t,n){let i,{data:o}=t,{sheetName:a}=t,{config:r}=t,{fieldName:s}=t,{columnSettings:l}=t,c=[];return e.$$set=e=>{"data"in e&&n(0,o=e.data),"sheetName"in e&&n(1,a=e.sheetName),"config"in e&&n(2,r=e.config),"fieldName"in e&&n(4,s=e.fieldName),"columnSettings"in e&&n(5,l=e.columnSettings)},e.$$.update=()=>{if(6&e.$$.dirty&&n(9,i=r.depotInfo.columns[r.depotInfo.sheets.guids[r.depotInfo.sheets.names.indexOf(a)]]),568&e.$$.dirty&&(n(3,c=void 0!==i?i.names:[]),l[s]+"@"+s in l)){let e=l[l[s]+"@"+s];"allowedTypes"in e&&(n(3,c=c.filter(t=>{let n=c.findIndex(e=>e==t||"id"==e||"guid"==e);return e.allowedTypes.includes(i.typeStrs[n])})),c.push("id","guid"))}},[o,a,r,c,s,l,function(e){o=e,n(0,o)},function(e){o=e,n(0,o)},function(e){o=e,n(0,o)}]}class To extends Z{constructor(e){super(),X(this,e,Go,ko,a,{data:0,sheetName:1,config:2,fieldName:4,columnSettings:5})}}function jo(e,t,n){const i=e.slice();return i[24]=t[n],i[25]=t,i[26]=n,i}function Lo(e,t,n){const i=e.slice();return i[21]=t[n],i[23]=n,i}function Vo(e){let t,n,i,o=e[0],a=[];for(let t=0;t<o.length;t+=1)a[t]=Wo(jo(e,o,t));const d=e=>B(a[e],1,1,()=>{a[e]=null});return{c(){t=u("tr");for(let e=0;e<a.length;e+=1)a[e].c();n=p()},m(e,o){s(e,t,o);for(let e=0;e<a.length;e+=1)a[e].m(t,null);r(t,n),i=!0},p(e,i){if(635&i){let r;for(o=e[0],r=0;r<o.length;r+=1){const s=jo(e,o,r);a[r]?(a[r].p(s,i),M(a[r],1)):(a[r]=Wo(s),a[r].c(),M(a[r],1),a[r].m(t,n))}for(F(),r=o.length;r<a.length;r+=1)d(r);H()}},i(e){if(!i){for(let e=0;e<o.length;e+=1)M(a[e]);i=!0}},o(e){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)B(a[e]);i=!1},d(e){e&&l(t),c(a,e)}}}function Ao(e){let t,n,i,o,a,c,f,m,h,g,v;function y(t){e[15].call(null,t,e[24],e[25],e[26])}let $={allowEmpty:!1,options:e[6]};void 0!==e[24]&&($.data=e[24]),a=new Te({props:$}),N.push(()=>J(a,"data",y)),a.$on("message",(function(...t){return e[16](e[26],...t)}));const w=[Ro,_o,Co,Po],x=[];function D(e,t){return"text"===e[24]?0:"bool"===e[24]?1:"longtext"===e[24]?2:"float"===e[24]||"int"===e[24]?3:-1}return~(h=D(e))&&(g=x[h]=w[h](e)),{c(){t=u("td"),n=d("["),i=d(e[26]),o=d("]\n                        "),q(a.$$.fragment),f=p(),m=u("div"),g&&g.c(),b(t,"width",e[4]+"px"),b(t,"height",e[5]+"px")},m(e,l){s(e,t,l),r(t,n),r(t,i),r(t,o),K(a,t,null),r(t,f),r(t,m),~h&&x[h].m(m,null),v=!0},p(n,i){e=n;const o={};64&i&&(o.options=e[6]),!c&&1&i&&(c=!0,o.data=e[24],V(()=>c=!1)),a.$set(o);let r=h;h=D(e),h===r?~h&&x[h].p(e,i):(g&&(F(),B(x[r],1,1,()=>{x[r]=null}),H()),~h?(g=x[h],g||(g=x[h]=w[h](e),g.c()),M(g,1),g.m(m,null)):g=null),(!v||16&i)&&b(t,"width",e[4]+"px"),(!v||32&i)&&b(t,"height",e[5]+"px")},i(e){v||(M(a.$$.fragment,e),M(g),v=!0)},o(e){B(a.$$.fragment,e),B(g),v=!1},d(e){e&&l(t),z(a),~h&&x[h].d()}}}function Po(e){let t,n,i;function o(t){e[20].call(null,t,e[26])}let a={};return void 0!==e[1][e[26]]&&(a.data=e[1][e[26]]),t=new Wn({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};!n&&2&o&&(n=!0,a.data=e[1][e[26]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Co(e){let t,n,i;function o(t){e[19].call(null,t,e[26])}let a={};return void 0!==e[1][e[26]]&&(a.data=e[1][e[26]]),t=new Tn({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};!n&&2&o&&(n=!0,a.data=e[1][e[26]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function _o(e){let t,n,i;function o(t){e[18].call(null,t,e[26])}let a={};return void 0!==e[1][e[26]]&&(a.data=e[1][e[26]]),t=new Ie({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};!n&&2&o&&(n=!0,a.data=e[1][e[26]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Ro(e){let t,n,i;function o(t){e[17].call(null,t,e[26])}let a={};return void 0!==e[1][e[26]]&&(a.data=e[1][e[26]]),t=new we({props:a}),N.push(()=>J(t,"data",o)),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(i,o){e=i;const a={};!n&&2&o&&(n=!0,a.data=e[1][e[26]],V(()=>n=!1)),t.$set(a)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Wo(e){let t,n,i=e[26]>=e[23]&&e[26]<e[23]+e[3]&&Ao(e);return{c(){i&&i.c(),t=f()},m(e,o){i&&i.m(e,o),s(e,t,o),n=!0},p(e,n){e[26]>=e[23]&&e[26]<e[23]+e[3]?i?(i.p(e,n),8&n&&M(i,1)):(i=Ao(e),i.c(),M(i,1),i.m(t.parentNode,t)):i&&(F(),B(i,1,1,()=>{i=null}),H())},i(e){n||(M(i),n=!0)},o(e){B(i),n=!1},d(e){i&&i.d(e),e&&l(t)}}}function Fo(e){let t,n,i=e[23]%e[3]==0&&Vo(e);return{c(){i&&i.c(),t=f()},m(e,o){i&&i.m(e,o),s(e,t,o),n=!0},p(e,n){e[23]%e[3]==0?i?(i.p(e,n),8&n&&M(i,1)):(i=Vo(e),i.c(),M(i,1),i.m(t.parentNode,t)):i&&(F(),B(i,1,1,()=>{i=null}),H())},i(e){n||(M(i),n=!0)},o(e){B(i),n=!1},d(e){i&&i.d(e),e&&l(t)}}}function Ho(e){let t,n,i,o,a,d,f,m,h,g,v,y,$,w,x,D,I,S,O,E,U,k,G,T,j,L,A,P,C,_,R;function W(t){e[11].call(null,t)}let Q={};function X(t){e[12].call(null,t)}void 0!==e[2]&&(Q.data=e[2]),d=new Wn({props:Q}),N.push(()=>J(d,"data",W));let Z={};function Y(t){e[13].call(null,t)}void 0!==e[3]&&(Z.data=e[3]),$=new Wn({props:Z}),N.push(()=>J($,"data",X));let ee={};function te(t){e[14].call(null,t)}void 0!==e[4]&&(ee.data=e[4]),E=new Wn({props:ee}),N.push(()=>J(E,"data",Y));let ne={};void 0!==e[5]&&(ne.data=e[5]),A=new Wn({props:ne}),N.push(()=>J(A,"data",te));let ie=e[0],oe=[];for(let t=0;t<ie.length;t+=1)oe[t]=Fo(Lo(e,ie,t));const ae=e=>B(oe[e],1,1,()=>{oe[e]=null});return{c(){t=u("table"),n=u("tr"),i=u("td"),i.textContent="Length",o=p(),a=u("td"),q(d.$$.fragment),m=p(),h=u("tr"),g=u("td"),g.textContent="Display Width",v=p(),y=u("td"),q($.$$.fragment),x=p(),D=u("tr"),I=u("td"),I.textContent="Column Width",S=p(),O=u("td"),q(E.$$.fragment),k=p(),G=u("tr"),T=u("td"),T.textContent="Column Height",j=p(),L=u("td"),q(A.$$.fragment),C=p(),_=u("table");for(let e=0;e<oe.length;e+=1)oe[e].c();b(_,"width",e[7]+"px"),b(_,"height",e[8]+"px")},m(e,l){s(e,t,l),r(t,n),r(n,i),r(n,o),r(n,a),K(d,a,null),r(t,m),r(t,h),r(h,g),r(h,v),r(h,y),K($,y,null),r(t,x),r(t,D),r(D,I),r(D,S),r(D,O),K(E,O,null),r(t,k),r(t,G),r(G,T),r(G,j),r(G,L),K(A,L,null),s(e,C,l),s(e,_,l);for(let e=0;e<oe.length;e+=1)oe[e].m(_,null);R=!0},p(e,[t]){const n={};!f&&4&t&&(f=!0,n.data=e[2],V(()=>f=!1)),d.$set(n);const i={};!w&&8&t&&(w=!0,i.data=e[3],V(()=>w=!1)),$.$set(i);const o={};!U&&16&t&&(U=!0,o.data=e[4],V(()=>U=!1)),E.$set(o);const a={};if(!P&&32&t&&(P=!0,a.data=e[5],V(()=>P=!1)),A.$set(a),635&t){let n;for(ie=e[0],n=0;n<ie.length;n+=1){const i=Lo(e,ie,n);oe[n]?(oe[n].p(i,t),M(oe[n],1)):(oe[n]=Fo(i),oe[n].c(),M(oe[n],1),oe[n].m(_,null))}for(F(),n=ie.length;n<oe.length;n+=1)ae(n);H()}(!R||128&t)&&b(_,"width",e[7]+"px"),(!R||256&t)&&b(_,"height",e[8]+"px")},i(e){if(!R){M(d.$$.fragment,e),M($.$$.fragment,e),M(E.$$.fragment,e),M(A.$$.fragment,e);for(let e=0;e<ie.length;e+=1)M(oe[e]);R=!0}},o(e){B(d.$$.fragment,e),B($.$$.fragment,e),B(E.$$.fragment,e),B(A.$$.fragment,e),oe=oe.filter(Boolean);for(let e=0;e<oe.length;e+=1)B(oe[e]);R=!1},d(e){e&&l(t),z(d),z($),z(E),z(A),e&&l(C),e&&l(_),c(oe,e)}}}function Mo(e,t,n){let{schemaData:i}=t,{defaultValues:o}=t,{length:a}=t,{displayWidth:r}=t,{gridSettings:s}=t,{columnWidth:l}=t,{columnHeight:c}=t,u=[],d=100,p=100;function f(e){n(1,o[e]=he[i[e]].defaultValue,o)}return e.$$set=e=>{"schemaData"in e&&n(0,i=e.schemaData),"defaultValues"in e&&n(1,o=e.defaultValues),"length"in e&&n(2,a=e.length),"displayWidth"in e&&n(3,r=e.displayWidth),"gridSettings"in e&&n(10,s=e.gridSettings),"columnWidth"in e&&n(4,l=e.columnWidth),"columnHeight"in e&&n(5,c=e.columnHeight)},e.$$.update=()=>{if(7&e.$$.dirty&&(n(0,i=i.slice(0,a)),n(1,o=o.slice(0,a)),a>i.length)){let e=a-i.length;for(let t=0;t<e;t++)i.push("bool"),o.push(!0)}if(1088&e.$$.dirty){n(6,u=s.allowedTypes);let e=["lineReference","sheetReference","multiple","enum"];n(6,u=u.filter(t=>!e.includes(t)))}60&e.$$.dirty&&(n(7,d=r*l),n(8,p=a>r?a/r*c:c))},[i,o,a,r,l,c,u,d,p,f,s,function(e){a=e,n(2,a)},function(e){r=e,n(3,r)},function(e){l=e,n(4,l)},function(e){c=e,n(5,c)},function(e,t,r,s){r[s]=e,n(0,i),n(2,a),n(1,o)},e=>f(e),function(e,t){o[t]=e,n(1,o),n(0,i),n(2,a)},function(e,t){o[t]=e,n(1,o),n(0,i),n(2,a)},function(e,t){o[t]=e,n(1,o),n(0,i),n(2,a)},function(e,t){o[t]=e,n(1,o),n(0,i),n(2,a)}]}class Bo extends Z{constructor(e){super(),X(this,e,Mo,Ho,a,{schemaData:0,defaultValues:1,length:2,displayWidth:3,gridSettings:10,columnWidth:4,columnHeight:5})}}function Jo(e,t,n){const i=e.slice();return i[29]=t[n],i[30]=t,i[31]=n,i}function qo(e){let t,n,i,o,a,h,g,y,b,$,w,x,D,I,S,O,E,U,N,k,G,T,j,L=e[0].guid+"",V=e[6]&&Ko(e),A=Object.keys(e[5]),P=[];for(let t=0;t<A.length;t+=1)P[t]=ra(Jo(e,A,t));const C=e=>B(P[e],1,1,()=>{P[e]=null});function _(e,t){return"new"===e[1].operation?la:"edit"===e[1].operation?sa:void 0}let R=_(e),W=R&&R(e),J=e[2]&&ca(e);return{c(){t=u("p"),n=d(e[3]),i=p(),V&&V.c(),o=p(),a=u("table"),h=u("tr"),h.innerHTML="<td>Field</td> \n        <td>Value</td>",g=p(),y=u("tr"),b=u("td"),b.textContent="GUID",$=p(),w=u("td"),x=d(L),D=p();for(let e=0;e<P.length;e+=1)P[e].c();I=p(),S=u("br"),O=p(),W&&W.c(),E=p(),U=u("button"),U.textContent="Cancel",N=p(),J&&J.c(),k=f()},m(l,c){s(l,t,c),r(t,n),s(l,i,c),V&&V.m(l,c),s(l,o,c),s(l,a,c),r(a,h),r(a,g),r(a,y),r(y,b),r(y,$),r(y,w),r(w,x),r(a,D);for(let e=0;e<P.length;e+=1)P[e].m(a,null);s(l,I,c),s(l,S,c),s(l,O,c),W&&W.m(l,c),s(l,E,c),s(l,U,c),s(l,N,c),J&&J.m(l,c),s(l,k,c),G=!0,T||(j=m(U,"click",e[7]),T=!0)},p(e,t){if((!G||8&t[0])&&v(n,e[3]),e[6]?V?V.p(e,t):(V=Ko(e),V.c(),V.m(o.parentNode,o)):V&&(V.d(1),V=null),(!G||1&t[0])&&L!==(L=e[0].guid+"")&&v(x,L),35&t[0]){let n;for(A=Object.keys(e[5]),n=0;n<A.length;n+=1){const i=Jo(e,A,n);P[n]?(P[n].p(i,t),M(P[n],1)):(P[n]=ra(i),P[n].c(),M(P[n],1),P[n].m(a,null))}for(F(),n=A.length;n<P.length;n+=1)C(n);H()}R===(R=_(e))&&W?W.p(e,t):(W&&W.d(1),W=R&&R(e),W&&(W.c(),W.m(E.parentNode,E))),e[2]?J?J.p(e,t):(J=ca(e),J.c(),J.m(k.parentNode,k)):J&&(J.d(1),J=null)},i(e){if(!G){for(let e=0;e<A.length;e+=1)M(P[e]);G=!0}},o(e){P=P.filter(Boolean);for(let e=0;e<P.length;e+=1)B(P[e]);G=!1},d(e){e&&l(t),e&&l(i),V&&V.d(e),e&&l(o),e&&l(a),c(P,e),e&&l(I),e&&l(S),e&&l(O),W&&W.d(e),e&&l(E),e&&l(U),e&&l(N),J&&J.d(e),e&&l(k),T=!1,j()}}}function Ko(t){let n,i,o,a,r,c,f,h,g,v;return{c(){n=d("Depot has been updated since you first created this column. Click below to update this column to the latest version."),i=u("br"),o=d("\n        Note that any unsaved changes on this column will be reverted upon column update."),a=u("br"),r=p(),c=u("button"),c.textContent="Update Column",f=p(),h=u("br")},m(e,l){s(e,n,l),s(e,i,l),s(e,o,l),s(e,a,l),s(e,r,l),s(e,c,l),s(e,f,l),s(e,h,l),g||(v=m(c,"click",t[11]),g=!0)},p:e,d(e){e&&l(n),e&&l(i),e&&l(o),e&&l(a),e&&l(r),e&&l(c),e&&l(f),e&&l(h),g=!1,v()}}}function zo(e){let t,n,i,o,a,c,f,m,h,g,y,b=e[29]+"";const $=[oa,ia,na,ta,ea,Yo,Zo,Xo,Qo],w=[];function x(e,t){return"text"===e[5][e[29]]?0:"longtext"===e[5][e[29]]?1:"bool"===e[5][e[29]]?2:"sheetSelect"===e[5][e[29]]?3:"int"===e[5][e[29]]||"float"===e[5][e[29]]?4:"enum"===e[5][e[29]]?5:"grid"===e[5][e[29]]?6:(32&t[0]&&(c=!("lineSelect"!==e[5][e[29]].split("@")[0])),c?7:(32&t[0]&&(f=!("columnSelect"!==e[5][e[29]].split("@")[0])),f?8:-1))}return~(m=x(e,[-1]))&&(h=w[m]=$[m](e)),{c(){t=u("tr"),n=u("td"),i=d(b),o=p(),a=u("td"),h&&h.c(),g=p()},m(e,l){s(e,t,l),r(t,n),r(n,i),r(t,o),r(t,a),~m&&w[m].m(a,null),r(t,g),y=!0},p(e,t){(!y||32&t[0])&&b!==(b=e[29]+"")&&v(i,b);let n=m;m=x(e,t),m===n?~m&&w[m].p(e,t):(h&&(F(),B(w[n],1,1,()=>{w[n]=null}),H()),~m?(h=w[m],h||(h=w[m]=$[m](e),h.c()),M(h,1),h.m(a,null)):h=null)},i(e){y||(M(h),y=!0)},o(e){B(h),y=!1},d(e){e&&l(t),~m&&w[m].d()}}}function Qo(e){let t,n,i,o;function a(t){e[26].call(null,t,e[29])}let r={sheetName:e[0][e[5][e[29]].split("@")[1]],config:e[1],fieldName:e[29],columnSettings:e[5]};return void 0!==e[0][e[29]]&&(r.data=e[0][e[29]]),n=new To({props:r}),N.push(()=>J(n,"data",a)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};33&o[0]&&(a.sheetName=e[0][e[5][e[29]].split("@")[1]]),2&o[0]&&(a.config=e[1]),32&o[0]&&(a.fieldName=e[29]),32&o[0]&&(a.columnSettings=e[5]),!i&&33&o[0]&&(i=!0,a.data=e[0][e[29]],V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function Xo(e){let t,n,i,o,a,r,c,d=""!==e[0].sheet&&""!==e[0].defaultValue&&!e[1].depotInfo.lines[e[0].sheet].guids.includes(e[0][e[29]]);function m(t){e[24].call(null,t,e[29])}function h(t){e[25].call(null,t,e[29])}let g={config:e[1]};void 0!==e[0][e[29]]&&(g.data=e[0][e[29]]),void 0!==e[0][e[5][e[29]].split("@")[1]]&&(g.sheetGUID=e[0][e[5][e[29]].split("@")[1]]),n=new So({props:g}),N.push(()=>J(n,"data",m)),N.push(()=>J(n,"sheetGUID",h));let v=d&&aa(e);return{c(){t=u("div"),q(n.$$.fragment),a=p(),v&&v.c(),r=f()},m(e,i){s(e,t,i),K(n,t,null),s(e,a,i),v&&v.m(e,i),s(e,r,i),c=!0},p(t,a){e=t;const s={};2&a[0]&&(s.config=e[1]),!i&&33&a[0]&&(i=!0,s.data=e[0][e[29]],V(()=>i=!1)),!o&&33&a[0]&&(o=!0,s.sheetGUID=e[0][e[5][e[29]].split("@")[1]],V(()=>o=!1)),n.$set(s),35&a[0]&&(d=""!==e[0].sheet&&""!==e[0].defaultValue&&!e[1].depotInfo.lines[e[0].sheet].guids.includes(e[0][e[29]])),d?v?v.p(e,a):(v=aa(e),v.c(),v.m(r.parentNode,r)):v&&(v.d(1),v=null)},i(e){c||(M(n.$$.fragment,e),c=!0)},o(e){B(n.$$.fragment,e),c=!1},d(e){e&&l(t),z(n),e&&l(a),v&&v.d(e),e&&l(r)}}}function Zo(e){let t,n,i,o,a,r,c,d,p;function f(t){e[18].call(null,t,e[29])}function m(t){e[19].call(null,t)}function h(t){e[20].call(null,t)}function g(t){e[21].call(null,t)}function v(t){e[22].call(null,t)}function y(t){e[23].call(null,t)}let b={gridSettings:e[5]["grid@"+e[29]]};return void 0!==e[0][e[29]]&&(b.schemaData=e[0][e[29]]),void 0!==e[0].defaultValue&&(b.defaultValues=e[0].defaultValue),void 0!==e[0].length&&(b.length=e[0].length),void 0!==e[0].columnWidth&&(b.columnWidth=e[0].columnWidth),void 0!==e[0].columnHeight&&(b.columnHeight=e[0].columnHeight),void 0!==e[0].displayWidth&&(b.displayWidth=e[0].displayWidth),n=new Bo({props:b}),N.push(()=>J(n,"schemaData",f)),N.push(()=>J(n,"defaultValues",m)),N.push(()=>J(n,"length",h)),N.push(()=>J(n,"columnWidth",g)),N.push(()=>J(n,"columnHeight",v)),N.push(()=>J(n,"displayWidth",y)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),p=!0},p(t,s){e=t;const l={};32&s[0]&&(l.gridSettings=e[5]["grid@"+e[29]]),!i&&33&s[0]&&(i=!0,l.schemaData=e[0][e[29]],V(()=>i=!1)),!o&&1&s[0]&&(o=!0,l.defaultValues=e[0].defaultValue,V(()=>o=!1)),!a&&1&s[0]&&(a=!0,l.length=e[0].length,V(()=>a=!1)),!r&&1&s[0]&&(r=!0,l.columnWidth=e[0].columnWidth,V(()=>r=!1)),!c&&1&s[0]&&(c=!0,l.columnHeight=e[0].columnHeight,V(()=>c=!1)),!d&&1&s[0]&&(d=!0,l.displayWidth=e[0].displayWidth,V(()=>d=!1)),n.$set(l)},i(e){p||(M(n.$$.fragment,e),p=!0)},o(e){B(n.$$.fragment,e),p=!1},d(e){e&&l(t),z(n)}}}function Yo(e){let t,n,i,o;function a(t){e[17].call(null,t,e[29])}let r={allowEmpty:!1,options:e[5]["enum@"+e[29]].options};return void 0!==e[0][e[29]]&&(r.data=e[0][e[29]]),n=new Te({props:r}),N.push(()=>J(n,"data",a)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};32&o[0]&&(a.options=e[5]["enum@"+e[29]].options),!i&&33&o[0]&&(i=!0,a.data=e[0][e[29]],V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function ea(e){let t,n,i,o;function a(t){e[16].call(null,t,e[29])}let r={};return void 0!==e[0][e[29]]&&(r.data=e[0][e[29]]),n=new Wn({props:r}),N.push(()=>J(n,"data",a)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};!i&&33&o[0]&&(i=!0,a.data=e[0][e[29]],V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function ta(e){let t,n,i,o;function a(t){e[15].call(null,t,e[29])}let r={allowEmpty:"sheetSelect@"+e[29]in e[5]&&e[5]["sheetSelect@"+e[29]].allowEmpty,options:e[1].depotInfo.sheetsFiltered.guids,aliases:e[1].depotInfo.sheetsFiltered.names};return void 0!==e[0][e[29]]&&(r.data=e[0][e[29]]),n=new Te({props:r}),N.push(()=>J(n,"data",a)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};32&o[0]&&(a.allowEmpty="sheetSelect@"+e[29]in e[5]&&e[5]["sheetSelect@"+e[29]].allowEmpty),2&o[0]&&(a.options=e[1].depotInfo.sheetsFiltered.guids),2&o[0]&&(a.aliases=e[1].depotInfo.sheetsFiltered.names),!i&&33&o[0]&&(i=!0,a.data=e[0][e[29]],V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function na(e){let t,n,i,o;function a(t){e[14].call(null,t,e[29])}let r={};return void 0!==e[0][e[29]]&&(r.data=e[0][e[29]]),n=new Ie({props:r}),N.push(()=>J(n,"data",a)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};!i&&33&o[0]&&(i=!0,a.data=e[0][e[29]],V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function ia(e){let t,n,i,o;function a(t){e[13].call(null,t,e[29])}let r={};return void 0!==e[0][e[29]]&&(r.data=e[0][e[29]]),n=new Tn({props:r}),N.push(()=>J(n,"data",a)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};!i&&33&o[0]&&(i=!0,a.data=e[0][e[29]],V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function oa(e){let t,n,i,o;function a(t){e[12].call(null,t,e[29])}let r={};return void 0!==e[0][e[29]]&&(r.data=e[0][e[29]]),n=new we({props:r}),N.push(()=>J(n,"data",a)),{c(){t=u("div"),q(n.$$.fragment)},m(e,i){s(e,t,i),K(n,t,null),o=!0},p(t,o){e=t;const a={};!i&&33&o[0]&&(i=!0,a.data=e[0][e[29]],V(()=>i=!1)),n.$set(a)},i(e){o||(M(n.$$.fragment,e),o=!0)},o(e){B(n.$$.fragment,e),o=!1},d(e){e&&l(t),z(n)}}}function aa(e){let t,n,i,o,a=e[0][e[29]]+"";return{c(){t=u("div"),n=d("Warning: Selected value with GUID "),i=d(a),o=d(" not in selected sheet")},m(e,a){s(e,t,a),r(t,n),r(t,i),r(t,o)},p(e,t){33&t[0]&&a!==(a=e[0][e[29]]+"")&&v(i,a)},d(e){e&&l(t)}}}function ra(e){let t,n,i="object"!=typeof e[5][e[29]]&&zo(e);return{c(){i&&i.c(),t=f()},m(e,o){i&&i.m(e,o),s(e,t,o),n=!0},p(e,n){"object"!=typeof e[5][e[29]]?i?(i.p(e,n),32&n[0]&&M(i,1)):(i=zo(e),i.c(),M(i,1),i.m(t.parentNode,t)):i&&(F(),B(i,1,1,()=>{i=null}),H())},i(e){n||(M(i),n=!0)},o(e){B(i),n=!1},d(e){i&&i.d(e),e&&l(t)}}}function sa(e){let t,n,o,a,c,f,h;return{c(){t=u("button"),n=d("Save"),a=p(),c=u("button"),c.textContent="Delete",t.disabled=o=!e[4]},m(i,o){s(i,t,o),r(t,n),s(i,a,o),s(i,c,o),f||(h=[m(t,"click",e[9]),m(c,"click",e[10])],f=!0)},p(e,n){16&n[0]&&o!==(o=!e[4])&&(t.disabled=o)},d(e){e&&l(t),e&&l(a),e&&l(c),f=!1,i(h)}}}function la(e){let t,n,i,o,a;return{c(){t=u("button"),n=d("Create"),t.disabled=i=!e[4]},m(i,l){s(i,t,l),r(t,n),o||(a=m(t,"click",e[8]),o=!0)},p(e,n){16&n[0]&&i!==(i=!e[4])&&(t.disabled=i)},d(e){e&&l(t),o=!1,a()}}}function ca(e){let t,n,i,o,a,c=JSON.stringify({data:e[0]},null,2)+"",f=JSON.stringify({config:e[1]},null,2)+"";return{c(){t=u("pre"),n=d(c),i=p(),o=u("pre"),a=d(f)},m(e,l){s(e,t,l),r(t,n),s(e,i,l),s(e,o,l),r(o,a)},p(e,t){1&t[0]&&c!==(c=JSON.stringify({data:e[0]},null,2)+"")&&v(n,c),2&t[0]&&f!==(f=JSON.stringify({config:e[1]},null,2)+"")&&v(a,f)},d(e){e&&l(t),e&&l(i),e&&l(o)}}}function ua(e){let t,n,i=e[1].active&&qo(e);return{c(){i&&i.c(),t=f()},m(e,o){i&&i.m(e,o),s(e,t,o),n=!0},p(e,n){e[1].active?i?(i.p(e,n),2&n[0]&&M(i,1)):(i=qo(e),i.c(),M(i,1),i.m(t.parentNode,t)):i&&(F(),B(i,1,1,()=>{i=null}),H())},i(e){n||(M(i),n=!0)},o(e){B(i),n=!1},d(e){i&&i.d(e),e&&l(t)}}}function da(e,t,n){const i=I();function o(e){i("message",{type:e})}let{data:a}=t,{config:r}=t,{debug:s}=t,l="";let c=!0,u={},d=!1;return e.$$set=e=>{"data"in e&&n(0,a=e.data),"config"in e&&n(1,r=e.config),"debug"in e&&n(2,s=e.debug)},e.$$.update=()=>{if(2&e.$$.dirty[0]){let e="new"===r.operation?"New ":"Edit ",t="sheet"===r.editType?"sheet config":"column config";n(3,l=e+t)}if(3&e.$$.dirty[0]&&r.active)switch(r.editType){case"sheet":n(4,c=!r.bannedNames.sheetNames.includes(a.name));break;default:n(4,c=!r.bannedNames.columnNames.includes(a.name))}3&e.$$.dirty[0]&&("edit"===r.operation?n(5,u=a.configurable):"new"===r.operation&&n(5,u=he[r.editType].configurable)),3&e.$$.dirty[0]&&("edit"===r.operation&&"sheet"!==r.editType?(n(6,d=!1),Object.keys(he[a.typeStr]).forEach(e=>{if("configurable"!==e){if(!(e in a))return void n(6,d=!0)}else Object.keys(he[a.typeStr].configurable).forEach(e=>{e in a.configurable||n(6,d=!0)})})):n(6,d=!1))},[a,r,s,l,c,u,d,function(){o("close")},function(){o("create")},function(){o("save")},function(){o("delete")},function(){o("upgradeColumnData")},function(e,t){a[t]=e,n(0,a)},function(e,t){a[t]=e,n(0,a)},function(e,t){a[t]=e,n(0,a)},function(e,t){a[t]=e,n(0,a)},function(e,t){a[t]=e,n(0,a)},function(e,t){a[t]=e,n(0,a)},function(e,t){a[t]=e,n(0,a)},function(e){a.defaultValue=e,n(0,a)},function(e){a.length=e,n(0,a)},function(e){a.columnWidth=e,n(0,a)},function(e){a.columnHeight=e,n(0,a)},function(e){a.displayWidth=e,n(0,a)},function(e,t){a[t]=e,n(0,a)},function(e,t){a[u[t].split("@")[1]]=e,n(0,a)},function(e,t){a[t]=e,n(0,a)}]}class pa extends Z{constructor(e){super(),X(this,e,da,ua,a,{data:0,config:1,debug:2},[-1,-1])}}function fa(e,t,n){const i=e.slice();return i[46]=t[n],i}function ma(e,t,n){const i=e.slice();return i[49]=t[n],i}function ha(e){let t,n,i,o,a,m,h,g,y,b,$,w,x,D,I,S,O,E,U,k,G,T,j=e[0].sheets[e[8]].name+"",L=e[0].sheets[e[8]].description+"";function A(t){e[20].call(null,t)}function P(t){e[21].call(null,t)}function C(t){e[22].call(null,t)}function _(t){e[23].call(null,t)}function R(t){e[24].call(null,t)}function W(t){e[25].call(null,t)}function Q(t){e[26].call(null,t)}let X={};void 0!==e[1]&&(X.debug=e[1]),void 0!==e[2]&&(X.showLineGUIDs=e[2]),void 0!==e[3]&&(X.previewDisclosedFields=e[3]),void 0!==e[4]&&(X.showNestedNames=e[4]),void 0!==e[5]&&(X.showNestedPaths=e[5]),void 0!==e[7]&&(X.allowAddRemoveItems=e[7]),void 0!==e[6]&&(X.allowSchemaEditing=e[6]),h=new ye({props:X}),N.push(()=>J(h,"debug",A)),N.push(()=>J(h,"showLineGUIDs",P)),N.push(()=>J(h,"previewDisclosedFields",C)),N.push(()=>J(h,"showNestedNames",_)),N.push(()=>J(h,"showNestedPaths",R)),N.push(()=>J(h,"allowAddRemoveItems",W)),N.push(()=>J(h,"allowSchemaEditing",Q));let Z=e[6]&&ya(e),Y=e[0].sheets,ee=[];for(let t=0;t<Y.length;t+=1)ee[t]=wa(fa(e,Y,t));U=new pa({props:{debug:e[1],data:e[11].active?e[12]:{},config:e[11]}}),U.$on("message",e[15]);let te=!e[11].active&&xa(e);return{c(){t=u("h1"),n=d(j),i=p(),o=u("p"),a=d(L),m=p(),q(h.$$.fragment),I=p(),Z&&Z.c(),S=p(),O=u("div");for(let e=0;e<ee.length;e+=1)ee[e].c();E=p(),q(U.$$.fragment),k=p(),te&&te.c(),G=f()},m(e,l){s(e,t,l),r(t,n),s(e,i,l),s(e,o,l),r(o,a),s(e,m,l),K(h,e,l),s(e,I,l),Z&&Z.m(e,l),s(e,S,l),s(e,O,l);for(let e=0;e<ee.length;e+=1)ee[e].m(O,null);s(e,E,l),K(U,e,l),s(e,k,l),te&&te.m(e,l),s(e,G,l),T=!0},p(e,t){(!T||257&t[0])&&j!==(j=e[0].sheets[e[8]].name+"")&&v(n,j),(!T||257&t[0])&&L!==(L=e[0].sheets[e[8]].description+"")&&v(a,L);const i={};if(!g&&2&t[0]&&(g=!0,i.debug=e[1],V(()=>g=!1)),!y&&4&t[0]&&(y=!0,i.showLineGUIDs=e[2],V(()=>y=!1)),!b&&8&t[0]&&(b=!0,i.previewDisclosedFields=e[3],V(()=>b=!1)),!$&&16&t[0]&&($=!0,i.showNestedNames=e[4],V(()=>$=!1)),!w&&32&t[0]&&(w=!0,i.showNestedPaths=e[5],V(()=>w=!1)),!x&&128&t[0]&&(x=!0,i.allowAddRemoveItems=e[7],V(()=>x=!1)),!D&&64&t[0]&&(D=!0,i.allowSchemaEditing=e[6],V(()=>D=!1)),h.$set(i),e[6]?Z?Z.p(e,t):(Z=ya(e),Z.c(),Z.m(S.parentNode,S)):Z&&(Z.d(1),Z=null),18689&t[0]){let n;for(Y=e[0].sheets,n=0;n<Y.length;n+=1){const i=fa(e,Y,n);ee[n]?ee[n].p(i,t):(ee[n]=wa(i),ee[n].c(),ee[n].m(O,null))}for(;n<ee.length;n+=1)ee[n].d(1);ee.length=Y.length}const o={};2&t[0]&&(o.debug=e[1]),6144&t[0]&&(o.data=e[11].active?e[12]:{}),2048&t[0]&&(o.config=e[11]),U.$set(o),e[11].active?te&&(F(),B(te,1,1,()=>{te=null}),H()):te?(te.p(e,t),2048&t[0]&&M(te,1)):(te=xa(e),te.c(),M(te,1),te.m(G.parentNode,G))},i(e){T||(M(h.$$.fragment,e),M(U.$$.fragment,e),M(te),T=!0)},o(e){B(h.$$.fragment,e),B(U.$$.fragment,e),B(te),T=!1},d(e){e&&l(t),e&&l(i),e&&l(o),e&&l(m),z(h,e),e&&l(I),Z&&Z.d(e),e&&l(S),e&&l(O),c(ee,e),e&&l(E),z(U,e),e&&l(k),te&&te.d(e),e&&l(G)}}}function ga(e){let t,n,i,o,a,r,c,d;a=new pa({props:{debug:e[1],data:e[11].active?e[12]:{},config:e[11]}}),a.$on("message",e[15]);let m=!e[11].active&&Da(e);return{c(){t=u("h1"),t.textContent="Depot",n=p(),i=u("p"),i.textContent="Click the button below to create sheet in Depot and get started",o=p(),q(a.$$.fragment),r=p(),m&&m.c(),c=f()},m(e,l){s(e,t,l),s(e,n,l),s(e,i,l),s(e,o,l),K(a,e,l),s(e,r,l),m&&m.m(e,l),s(e,c,l),d=!0},p(e,t){const n={};2&t[0]&&(n.debug=e[1]),6144&t[0]&&(n.data=e[11].active?e[12]:{}),2048&t[0]&&(n.config=e[11]),a.$set(n),e[11].active?m&&(m.d(1),m=null):m?m.p(e,t):(m=Da(e),m.c(),m.m(c.parentNode,c))},i(e){d||(M(a.$$.fragment,e),d=!0)},o(e){B(a.$$.fragment,e),d=!1},d(e){e&&l(t),e&&l(n),e&&l(i),e&&l(o),z(a,e),e&&l(r),m&&m.d(e),e&&l(c)}}}function va(t){let n,i,o,a,r;return{c(){n=u("h1"),n.textContent="Depot",i=p(),o=u("p"),o.textContent="Invalid Depot File",a=p(),r=u("p"),r.textContent='Use Ctrl/Cmd+Shift+P and select "Create new Depot File" to get started'},m(e,t){s(e,n,t),s(e,i,t),s(e,o,t),s(e,a,t),s(e,r,t)},p:e,i:e,o:e,d(e){e&&l(n),e&&l(i),e&&l(o),e&&l(a),e&&l(r)}}}function ya(e){let t,n,o,a,d,g,v,y,b,$,w,x,D,I=Object.keys(he),S=[];for(let t=0;t<I.length;t+=1)S[t]=ba(ma(e,I,t));return{c(){t=u("button"),n=u("img"),d=p(),g=u("button"),v=u("img"),$=p();for(let e=0;e<S.length;e+=1)S[e].c();w=f(),n.src!==(o=e[13].newSheet.path)&&h(n,"src",o),h(n,"alt","New Sheet"),h(t,"class","buttonIcon padded svelte-17x4mj9"),h(t,"title","New sheet"),t.disabled=a=e[11].active,v.src!==(y=e[13].editSheet.path)&&h(v,"src",y),h(v,"alt","Edit Sheet"),h(g,"class","buttonIcon padded svelte-17x4mj9"),h(g,"title","Edit sheet"),g.disabled=b=e[11].active},m(i,o){s(i,t,o),r(t,n),s(i,d,o),s(i,g,o),r(g,v),s(i,$,o);for(let e=0;e<S.length;e+=1)S[e].m(i,o);s(i,w,o),x||(D=[m(t,"click",e[17]),m(g,"click",e[19])],x=!0)},p(e,n){if(2048&n[0]&&a!==(a=e[11].active)&&(t.disabled=a),2048&n[0]&&b!==(b=e[11].active)&&(g.disabled=b),272384&n[0]){let t;for(I=Object.keys(he),t=0;t<I.length;t+=1){const i=ma(e,I,t);S[t]?S[t].p(i,n):(S[t]=ba(i),S[t].c(),S[t].m(w.parentNode,w))}for(;t<S.length;t+=1)S[t].d(1);S.length=I.length}},d(e){e&&l(t),e&&l(d),e&&l(g),e&&l($),c(S,e),e&&l(w),x=!1,i(D)}}}function ba(e){let t,n="sheet"!==e[49]&&function(e){let t,n,i,o,a,c,d,f,g;function v(...t){return e[27](e[49],...t)}return{c(){t=u("button"),n=u("img"),a=p(),n.src!==(i=e[13][he[e[49]].iconName].path)&&h(n,"src",i),h(n,"alt",o="Create new "+e[49]+" column"),h(t,"class","buttonIcon padded svelte-17x4mj9"),t.disabled=c=e[11].active,h(t,"title",d="Create new "+e[49]+" column")},m(e,i){s(e,t,i),r(t,n),r(t,a),f||(g=m(t,"click",v),f=!0)},p(n,i){e=n,2048&i[0]&&c!==(c=e[11].active)&&(t.disabled=c)},d(e){e&&l(t),f=!1,g()}}}(e);return{c(){n&&n.c(),t=f()},m(e,i){n&&n.m(e,i),s(e,t,i)},p(e,t){"sheet"!==e[49]&&n.p(e,t)},d(e){n&&n.d(e),e&&l(t)}}}function $a(e){let t,n,i,a,c,p,f=e[46].name+"";return{c(){t=u("button"),n=d(f),h(t,"class",i="sheetButton "+(e[0].sheets.indexOf(e[46])==e[8]?"selected":"")+" svelte-17x4mj9"),h(t,"title","Select sheet"),t.disabled=a=e[11].active},m(i,a){s(i,t,a),r(t,n),c||(p=m(t,"click",(function(){o(e[14](e[0].sheets.indexOf(e[46])))&&e[14](e[0].sheets.indexOf(e[46])).apply(this,arguments)})),c=!0)},p(o,r){e=o,1&r[0]&&f!==(f=e[46].name+"")&&v(n,f),257&r[0]&&i!==(i="sheetButton "+(e[0].sheets.indexOf(e[46])==e[8]?"selected":"")+" svelte-17x4mj9")&&h(t,"class",i),2048&r[0]&&a!==(a=e[11].active)&&(t.disabled=a)},d(e){e&&l(t),c=!1,p()}}}function wa(e){let t,n=!e[46].hidden&&$a(e);return{c(){n&&n.c(),t=f()},m(e,i){n&&n.m(e,i),s(e,t,i)},p(e,i){e[46].hidden?n&&(n.d(1),n=null):n?n.p(e,i):(n=$a(e),n.c(),n.m(t.parentNode,t))},d(e){n&&n.d(e),e&&l(t)}}}function xa(e){let t,n,i,o,a,r;function s(t){e[28].call(null,t)}function l(t){e[29].call(null,t)}function c(t){e[30].call(null,t)}function u(t){e[31].call(null,t)}let d={debug:e[1],showLineGUIDs:e[2],previewDisclosedFields:e[3],showNestedNames:e[4],showNestedPaths:e[5],allowSchemaEditing:e[6],allowAddRemoveItems:e[7],depotInfo:e[10],baseDataPath:e[0].sheets[e[8]].name};return void 0!==e[0]&&(d.fullData=e[0]),void 0!==e[0].sheets[e[8]]&&(d.sheetData=e[0].sheets[e[8]]),void 0!==e[0].sheets[e[8]].lines&&(d.inputLineData=e[0].sheets[e[8]].lines),void 0!==e[9]&&(d.listVisibility=e[9]),t=new $o({props:d}),N.push(()=>J(t,"fullData",s)),N.push(()=>J(t,"sheetData",l)),N.push(()=>J(t,"inputLineData",c)),N.push(()=>J(t,"listVisibility",u)),t.$on("message",e[16]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),r=!0},p(e,r){const s={};2&r[0]&&(s.debug=e[1]),4&r[0]&&(s.showLineGUIDs=e[2]),8&r[0]&&(s.previewDisclosedFields=e[3]),16&r[0]&&(s.showNestedNames=e[4]),32&r[0]&&(s.showNestedPaths=e[5]),64&r[0]&&(s.allowSchemaEditing=e[6]),128&r[0]&&(s.allowAddRemoveItems=e[7]),1024&r[0]&&(s.depotInfo=e[10]),257&r[0]&&(s.baseDataPath=e[0].sheets[e[8]].name),!n&&1&r[0]&&(n=!0,s.fullData=e[0],V(()=>n=!1)),!i&&257&r[0]&&(i=!0,s.sheetData=e[0].sheets[e[8]],V(()=>i=!1)),!o&&257&r[0]&&(o=!0,s.inputLineData=e[0].sheets[e[8]].lines,V(()=>o=!1)),!a&&512&r[0]&&(a=!0,s.listVisibility=e[9],V(()=>a=!1)),t.$set(s)},i(e){r||(M(t.$$.fragment,e),r=!0)},o(e){B(t.$$.fragment,e),r=!1},d(e){z(t,e)}}}function Da(t){let n,i,o,a,c;return{c(){n=u("button"),i=u("img"),i.src!==(o=t[13].newSheet.path)&&h(i,"src",o),h(i,"alt","New Sheet"),h(n,"class","buttonIcon padded svelte-17x4mj9"),h(n,"title","New sheet")},m(e,o){s(e,n,o),r(n,i),a||(c=m(n,"click",t[17]),a=!0)},p:e,d(e){e&&l(n),a=!1,c()}}}function Ia(e){let t,n,i,o,a,c,f,m,h=JSON.stringify({data:e[0]},null,2)+"";return{c(){t=u("p"),n=d("Selected Sheet: "),i=d(e[8]),o=p(),a=u("p"),a.textContent="Raw Data:",c=p(),f=u("pre"),m=d(h)},m(e,l){s(e,t,l),r(t,n),r(t,i),s(e,o,l),s(e,a,l),s(e,c,l),s(e,f,l),r(f,m)},p(e,t){256&t[0]&&v(i,e[8]),1&t[0]&&h!==(h=JSON.stringify({data:e[0]},null,2)+"")&&v(m,h)},d(e){e&&l(t),e&&l(o),e&&l(a),e&&l(c),e&&l(f)}}}function Sa(e){let t,n,i,o,a,r;const c=[va,ga,ha],u=[];function d(e,n){return 1&n[0]&&(t=!e[0].hasOwnProperty("sheets")),t?0:0===e[0].sheets.length?1:2}n=d(e,[-1]),i=u[n]=c[n](e);let m=e[1]&&Ia(e);return{c(){i.c(),o=p(),m&&m.c(),a=f()},m(e,t){u[n].m(e,t),s(e,o,t),m&&m.m(e,t),s(e,a,t),r=!0},p(e,t){let r=n;n=d(e,t),n===r?u[n].p(e,t):(F(),B(u[r],1,1,()=>{u[r]=null}),H(),i=u[n],i||(i=u[n]=c[n](e),i.c()),M(i,1),i.m(o.parentNode,o)),e[1]?m?m.p(e,t):(m=Ia(e),m.c(),m.m(a.parentNode,a)):m&&(m.d(1),m=null)},i(e){r||(M(i),r=!0)},o(e){B(i),r=!1},d(e){u[n].d(e),e&&l(o),m&&m.d(e),e&&l(a)}}}function Oa(e,t,n,i){let o=[];if(Array.isArray(e))e.forEach((e,a)=>{if(Array.isArray(e[t[n]])){if(e[t[n]].length>0){var r=i+`[${a}]["${t[n]}"]`;n+1<t.length?o=o.concat(Oa(e[t[n]],t,n+1,r).paths):o.push(r)}}else if(Object.keys(e[t[n]]).length>0){r=i+`[${a}]["${t[n]}"]`;n+1<t.length?o=o.concat(Oa(e[t[n]],t,n+1,r).paths):o.push(r)}});else if(console.log(e),console.log(n),console.log(t[n]),console.log(e[t[n]]),Array.isArray(e[t[n]])){if(e[t[n]].length>0){var a=i+`["${t[n]}"]`;n+1<t.length?o=o.concat(Oa(e[t[n]],t,n+1,a).paths):o.push(a)}}else if(Object.keys(e[t[n]]).length>0){a=i+`["${t[n]}"]`;n+1<t.length?o=o.concat(Oa(e[t[n]],t,n+1,a).paths):o.push(a)}return{paths:o}}function Ea(e,t,n){let{data:i}=t,o=!1,a=!1,r=!1,s=!0,l=!1,c=!0,u=!0,d=O("iconPaths");const p=I();function f(){p("message",{type:"update"})}let m=0;function h(e){n(8,m=e)}let g={};function v(e,t){var n=[];for(var o in i.sheets)("new"===t.operation||"edit"===t.operation&&e in i.sheets&&i.sheets[o].name!==i.sheets[i.sheets.indexOf(t=>t.guid===e)].name)&&n.push(i.sheets[o].name);var a=[];if(i.sheets.length>0){var r=i.sheets.findIndex(t=>t.guid===e);if(r>=0&&0!==i.sheets[r].columns.length)for(var o in i.sheets[r].columns)("new"===t.operation||"edit"===t.operation&&i.sheets[r].columns[o].name!==t.editType)&&a.push(i.sheets[r].columns[o].name)}return{sheetNames:n,columnNames:a}}let y={};function b(e,t){let n=i.sheets.findIndex(t=>t.guid===e);for(let e=1;e<=t;e++){var o={};o.guid=ei(),o.id=i.sheets[n].lines.length+"",i.sheets[n].columns.forEach(e=>{"multiple"==e.typeStr?o[e.name]=e.defaultValue.split(", "):o[e.name]=e.defaultValue}),i.sheets[n].lines.push(o)}f()}function $(e){var t=i.sheets[e].columnGUID;let n={},o=i.sheets.findIndex(t=>t.guid===i.sheets[e].parentSheetGUID);n.parentIndex=o;let a=i.sheets[o].columns.findIndex(e=>e.guid===t),r=[i.sheets[o].columns[a].name];return i.sheets[o].hidden&&(n=$(o),r=r.concat(n.path)),n.path=r,n}function w(e,t){i.sheets[e].hidden?function(e,t){let n=$(e);n.path.reverse();let o=Oa(i.sheets[n.parentIndex].lines,n.path,0,"");console.log("paths: "+o.paths),o.paths.forEach(e=>{console.log(me(i.sheets[n.parentIndex].lines,e));let o=me(i.sheets[n.parentIndex].lines,e);Array.isArray(o)?o.forEach(e=>{console.log("destination line:"),console.log(e),t(e)}):t(o)})}(e,e=>{t(e)}):i.sheets[e].lines.forEach(e=>{t(e)})}function x(e){let t=i.sheets.findIndex(t=>t.guid===e.sheet);Object.keys(g).forEach(t=>{g[t].guid===e.guid&&delete g[t]}),i.sheets[t].columns.forEach(e=>{"list"===e.typeStr&&x(e)}),i.sheets.splice(t,1)}let D={active:!1},S={};function E(e){let t=i.sheets.findIndex(t=>t.guid===e.detail.data.sheetGUID);switch(e.detail.type){case"editorUpdate":switch(n(11,D=e.detail.data),n(11,D.bannedNames=v(D.sheetGUID,D),D),n(11,D.depotInfo=y,D),D.operation){case"new":if(n(12,S=JSON.parse(JSON.stringify(he[D.editType]))),n(12,S.guid=ei(),S),"lineReference"===D.editType){let e=i.sheets.find(e=>!0!==e.hidden).guid;n(12,S.sheet=e,S)}break;case"edit":switch(D.editType){case"sheet":n(11,D.originalData=JSON.parse(JSON.stringify(i.sheets[t])),D),n(12,S=JSON.parse(JSON.stringify(i.sheets[t])));break;default:n(11,D.originalData=JSON.parse(JSON.stringify(i.sheets[t].columns.find(e=>e.name===D.editType))),D),n(12,S=JSON.parse(JSON.stringify(i.sheets[t].columns.find(e=>e.name===D.editType))))}}break;case"update":f();break;case"lineEdit":switch(e.detail.data.operation){case"remove":const n=e.detail.data.line.guid;i.sheets[t].lines.splice(e.detail.data.lineIndex,1),i.sheets.forEach(e=>{var t=e.columns.filter(e=>"lineReference"===e.typeStr);t.length>0&&(e.lines.forEach(e=>{t.forEach(t=>{e[t.name]===n&&(e[t.name]="")})}),t.forEach(e=>{e.defaultValue===n&&(e.defaultValue="")}))}),n in g&&delete g[n];break;case"add":i.sheets[t].hidden||b(e.detail.data.sheetGUID,e.detail.data.amount)}f();break;case"pickFile":var o=e.detail.fileKey;if(o.sheet=t,i.sheets[t].hidden){let e=$(t);e.path.reverse();let n=Oa(i.sheets[e.parentIndex].lines,e.path,0,"").paths.filter(t=>me(i.sheets[e.parentIndex].lines,t)[o.lineIndex].guid==o.line.guid);o.linePath=n[0],o.sheet=e.parentIndex}p("message",{type:"pickFile",fileKey:e.detail.fileKey})}}function U(e){E({detail:{type:"editorUpdate",data:{active:!0,operation:"new",editType:e,sheetGUID:i.sheets[m].guid}}})}return e.$$set=e=>{"data"in e&&n(0,i=e.data)},e.$$.update=()=>{if(1&e.$$.dirty[0]|6&e.$$.dirty[1]){var t=[],o=[],a=[],r=[],s={},l={};i.sheets.forEach(e=>{t.push(e.name),o.push(e.guid),e.hidden||(a.push(e.name),r.push(e.guid)),n(32,s[e.guid]={names:[],ids:[],guids:[]},s),n(33,l[e.guid]={names:[],guids:[],typeStrs:[]},l),e.lines.forEach(t=>{s[e.guid].names.push(t[e.displayColumn]),s[e.guid].ids.push(t.id),s[e.guid].guids.push(t.guid)}),e.columns.forEach(t=>{l[e.guid].names.push(t.name),l[e.guid].guids.push(t.guid),l[e.guid].typeStrs.push(t.typeStr)}),l[e.guid].names.push("id"),l[e.guid].names.push("guid")}),n(10,y={sheets:{names:t,guids:o},sheetsFiltered:{names:a,guids:r},lines:s,columns:l})}},[i,o,a,r,s,l,c,u,m,g,y,D,S,d,h,function(e){switch(e.detail.type){case"create":switch(D.editType){case"sheet":i.sheets.push(S),h(i.sheets.length-1),n(11,D={active:!1}),b(S.guid,1);break;default:let e=i.sheets.findIndex(e=>e.guid===D.sheetGUID);if(i.sheets[e].columns.push(S),w(e,e=>{"multiple"===S.typeStr?e[S.name]=S.defaultValue.split(", "):e[S.name]=S.defaultValue}),"list"===S.typeStr||"props"===S.typeStr){let t=JSON.parse(JSON.stringify(he.sheet));t.hidden=!0,t.description=S.typeStr+"@"+i.sheets[e].guid,"props"===S.typeStr&&(t.isProps=!0),t.parentSheetGUID=i.sheets[e].guid,t.columnGUID=S.guid;let o=ei();t.guid=o,n(0,i.sheets[e].columns[i.sheets[e].columns.findIndex(e=>e.guid===S.guid)].sheet=o,i),t.name=S.name,delete t.configurable,i.sheets.push(t)}n(11,D={active:!1}),f()}break;case"save":switch(D.editType){case"sheet":n(0,i.sheets[m]=S,i);break;default:let e=i.sheets.findIndex(e=>e.guid===D.sheetGUID);var t=i.sheets[e].columns.findIndex(e=>e.name===D.editType),o=JSON.parse(JSON.stringify(i.sheets[e].columns[t]));if(n(0,i.sheets[e].columns[t]=S,i),D.editType!==S.name&&(w(e,e=>{e[S.name]=e[D.editType],delete e[D.editType]}),i.sheets[e].displayColumn==D.editType&&n(0,i.sheets[e].displayColumn=S.name,i)),"multiple"==S.typeStr&&w(e,e=>{e[S.name]=e[S.name].filter(e=>S.options.includes(e))}),"enum"==S.typeStr&&w(e,e=>{S.options.includes(e[S.name])||(e[S.name]=S.defaultValue)}),"grid"==S.typeStr){var a=!1;if(S.defaultValue.length<o.defaultValue.length&&w(e,e=>{e[S.name]=e[S.name].slice(0,S.defaultValue.length),g.hasOwnProperty(e.guid)&&g[e.guid].guid==S.guid&&(delete g[e.guid],n(9,g[e.guid]=S,g),a=!0)}),S.defaultValue.length>o.defaultValue.length){var r=S.defaultValue.slice(o.defaultValue.length);w(e,e=>{e[S.name]=e[S.name].concat(r),g.hasOwnProperty(e.guid)&&g[e.guid].guid==S.guid&&(delete g[e.guid],n(9,g[e.guid]=S,g),a=!0)})}o.schema.forEach((t,i)=>{i<S.schema.length&&t!==S.schema[i]&&w(e,e=>{e[S.name][i]=S.defaultValue[i],g.hasOwnProperty(e.guid)&&g[e.guid].guid==S.guid&&(delete g[e.guid],n(9,g[e.guid]=S,g),a=!0)})}),a||o.displayWidth===S.displayWidth&&o.columnWidth===S.columnWidth&&o.columnHeight===S.columnHeight||w(e,e=>{g.hasOwnProperty(e.guid)&&g[e.guid].guid==S.guid&&(delete g[e.guid],n(9,g[e.guid]=S,g))})}"list"==S.typeStr&&Object.keys(g).forEach(e=>{g[e].guid===S.guid&&n(9,g[e].name=S.name,g)})}n(11,D={active:!1}),f();break;case"delete":switch(D.editType){case"sheet":const e=i.sheets[m].guid;i.sheets[m].columns.forEach(e=>{"list"===e.typeStr&&x(e)}),i.sheets.splice(m,1),h(0),i.sheets.forEach(t=>{var n=t.columns.filter(e=>"sheetReference"===e.typeStr),i=t.columns.filter(e=>"lineReference"===e.typeStr);if(n.length>0&&(t.lines.forEach(t=>{n.forEach(n=>{t[n.name]===e&&(t[n.name]="")})}),n.forEach(t=>{t.defaultValue===e&&(t.defaultValue="")})),i.length>0){let n=[];i.forEach(t=>{t.sheet===e&&(t.sheet="",t.defaultValue="",n.push(t))}),t.lines.forEach(e=>{n.forEach(t=>{e[t.name]=""})})}});break;default:let o=i.sheets.findIndex(e=>e.guid===D.sheetGUID);t=i.sheets[o].columns.findIndex(e=>e.name===D.editType);w(o,e=>{g.hasOwnProperty(e.guid)&&g[e.guid].guid==S.guid&&delete g[e.guid],delete e[D.editType]}),i.sheets[o].displayColumn===i.sheets[o].columns[t].name&&n(0,i.sheets[o].displayColumn=he.sheet.displayColumn,i),"list"===i.sheets[o].columns[t].typeStr&&x(i.sheets[o].columns[t]),i.sheets[o].columns.splice(t,1)}n(11,D={active:!1}),f();break;case"close":n(11,D={active:!1});break;case"upgradeColumnData":let e=i.sheets.findIndex(e=>e.guid===D.sheetGUID);t=i.sheets[e].columns.findIndex(e=>e.name===D.originalData.name);let s=i.sheets[e].columns[t];Object.keys(he[S.typeStr]).forEach(e=>{"configurable"!==e?e in s||(s[e]=he[S.typeStr][e]):Object.keys(he[S.typeStr].configurable).forEach(e=>{e in s.configurable||(s.configurable[e]=he[S.typeStr].configurable[e])})}),f(),E({detail:{type:"editorUpdate",data:{active:!0,operation:"edit",editType:D.originalData.name,sheetGUID:D.sheetGUID}}});break;default:n(11,D={active:!1})}},E,function(){n(11,D={active:!0,operation:"new",editType:"sheet"}),n(12,S=JSON.parse(JSON.stringify(he[D.editType])));let e=ei();n(12,S.guid=e,S),n(11,D.bannedNames=v(e,D),D),n(11,D.depotInfo=y,D)},U,function(){E({detail:{type:"editorUpdate",data:{active:!0,operation:"edit",editType:"sheet",sheetGUID:i.sheets[m].guid}}})},function(e){o=e,n(1,o)},function(e){a=e,n(2,a)},function(e){r=e,n(3,r)},function(e){s=e,n(4,s)},function(e){l=e,n(5,l)},function(e){u=e,n(7,u)},function(e){c=e,n(6,c)},e=>U(e),function(e){i=e,n(0,i)},function(e){i.sheets[m]=e,n(0,i)},function(e){i.sheets[m].lines=e,n(0,i)},function(e){g=e,n(9,g)}]}class Ua extends Z{constructor(e){super(),X(this,e,Ea,Sa,a,{data:0},[-1,-1])}}function Na(t){let n,i,o;return{c(){n=u("p"),i=d("Error: Invalid Data Type "),o=d(t[0])},m(e,t){s(e,n,t),r(n,i),r(n,o)},p(e,t){1&t&&v(o,e[0])},i:e,o:e,d(e){e&&l(n)}}}function ka(e){let t,n,i;function o(t){e[4].call(null,t)}let a={};return void 0!==e[1]&&(a.data=e[1]),t=new Ua({props:a}),N.push(()=>J(t,"data",o)),t.$on("message",e[3]),{c(){q(t.$$.fragment)},m(e,n){K(t,e,n),i=!0},p(e,i){const o={};!n&&2&i&&(n=!0,o.data=e[1],V(()=>n=!1)),t.$set(o)},i(e){i||(M(t.$$.fragment,e),i=!0)},o(e){B(t.$$.fragment,e),i=!1},d(e){z(t,e)}}}function Ga(t){let n;return{c(){n=u("p"),n.textContent="Loading"},m(e,t){s(e,n,t)},p:e,i:e,o:e,d(e){e&&l(n)}}}function Ta(e){let t,n,i,o,a,r;const c=[Ga,ka,Na],u=[];function d(e,t){return""==e[0]?0:"depot"===e[0]?1:2}return t=d(e),n=u[t]=c[t](e),{c(){n.c(),i=f()},m(n,l){u[t].m(n,l),s(n,i,l),o=!0,a||(r=m(window,"message",e[2]),a=!0)},p(e,[o]){let a=t;t=d(e),t===a?u[t].p(e,o):(F(),B(u[a],1,1,()=>{u[a]=null}),H(),n=u[t],n||(n=u[t]=c[t](e),n.c()),M(n,1),n.m(i.parentNode,i))},i(e){o||(M(n),o=!0)},o(e){B(n),o=!1},d(e){u[t].d(e),e&&l(i),a=!1,r()}}}function ja(e,t,n){var i;i=()=>{S("nonce",nonce),S("iconPaths",icons),vscode.postMessage({type:"init-view"})},D().$$.on_mount.push(i);let o="",a={};function r(e){console.log("updating content");try{console.log(JSON.parse(e)),n(1,a=JSON.parse(e))}catch{return}}return[o,a,function(e){const t=e.data;switch(t.type){case"init":console.log("initing view");const e=vscode.getState();return e?(console.log("found previous state: "+e.text),r(e.text)):(console.log("no previous state: initing"),r(t.text)),void n(0,o=t.jsonType);case"update":console.log("updating view");const s=t.text;return r(s),void vscode.setState({text:s});case"filePicked":var i=t.fileKey;if("linePath"in i){me(a.sheets[i.sheet].lines,i.linePath)[i.lineIndex][i.column.name]=t.filePath}else n(1,a.sheets[i.sheet].lines[i.lineIndex][i.column.name]=t.filePath,a);return void vscode.postMessage({type:"update",data:a})}},function(e){switch(console.log(e),e.detail.type){case"update":console.log("pushing data",a),vscode.postMessage({type:"update",data:a});break;case"pickFile":console.log("firing file picker"),vscode.postMessage({type:"pickFile",fileKey:e.detail.fileKey})}},function(e){a=e,n(1,a)}]}return new class extends Z{constructor(e){super(),X(this,e,ja,Ta,a,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
